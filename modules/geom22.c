#define GEOM22_C

#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include <gsl/gsl_complex.h>
#include <gsl/gsl_complex_math.h>
#include <gsl/gsl_matrix_complex_double.h>
#include <gsl/gsl_blas.h>
#include "geom.h"
#include "dirac.h"
#include "matop.h"
#include "global.h"

// TYPE (2,2) GEOMETRY

void geom_check22()
{
    if(nH != 4 || nL != 4)
    {
        printf("Error: geometry is not (4,0)\n");
        exit(EXIT_FAILURE);
    }
}

// build gamma matrices
void init_gamma22()
{
    
    for(int i=0; i<nH; i++)
        gammaH[i] = gsl_matrix_complex_calloc(dimG, dimG);
    for(int i=0; i<nL; i++)
        gammaL[i] = gsl_matrix_complex_calloc(dimG, dimG);

    // gammaH0
    gsl_matrix_complex_set(gammaH[0], 0, 0, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[0], 1, 1, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[0], 2, 2, gsl_complex_rect(-1.0, 0.0));
    gsl_matrix_complex_set(gammaH[0], 3, 3, gsl_complex_rect(-1.0, 0.0));
 
    // gammaH1
    gsl_matrix_complex_set(gammaH[1], 0, 2, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[1], 1, 3, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[1], 2, 0, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[1], 3, 1, gsl_complex_rect(1.0, 0.0));
 
    // gammaH2
    gsl_matrix_complex_set(gammaH[2], 0, 0, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[2], 1, 1, gsl_complex_rect(-1.0, 0.0));
    gsl_matrix_complex_set(gammaH[2], 2, 2, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaH[2], 3, 3, gsl_complex_rect(-1.0, 0.0));
 
    // gammaH3
    gsl_matrix_complex_set(gammaH[3], 0, 1, gsl_complex_rect(0.0, -1.0));
    gsl_matrix_complex_set(gammaH[3], 1, 0, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaH[3], 2, 3, gsl_complex_rect(0.0, -1.0));
    gsl_matrix_complex_set(gammaH[3], 3, 2, gsl_complex_rect(0.0, 1.0));
 
    // gammaL0
    gsl_matrix_complex_set(gammaL[0], 0, 2, gsl_complex_rect(-1.0, 0.0));
    gsl_matrix_complex_set(gammaL[0], 1, 3, gsl_complex_rect(1.0, -0.0));
    gsl_matrix_complex_set(gammaL[0], 2, 0, gsl_complex_rect(1.0, 0.0));
    gsl_matrix_complex_set(gammaL[0], 3, 1, gsl_complex_rect(-1.0, 0.0));
 
    // gammaL1
    gsl_matrix_complex_set(gammaL[1], 0, 3, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaL[1], 1, 2, gsl_complex_rect(-0.0, -1.0));
    gsl_matrix_complex_set(gammaL[1], 2, 1, gsl_complex_rect(0.0, -1.0));
    gsl_matrix_complex_set(gammaL[1], 3, 0, gsl_complex_rect(0.0, 1.0));
 
    // gammaL2
    gsl_matrix_complex_set(gammaL[2], 0, 1, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaL[2], 1, 0, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaL[2], 2, 3, gsl_complex_rect(0.0, -1.0));
    gsl_matrix_complex_set(gammaL[2], 3, 2, gsl_complex_rect(0.0, -1.0));
 
    // gammaL3
    gsl_matrix_complex_set(gammaL[3], 0, 3, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaL[3], 1, 2, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaL[3], 2, 1, gsl_complex_rect(0.0, 1.0));
    gsl_matrix_complex_set(gammaL[3], 3, 0, gsl_complex_rect(0.0, 1.0));
}


void actionD2t22(double* vecS, int* control)
{
    gsl_matrix_complex* H0 = H[0];
    gsl_complex trH0 = trace(H0);
    gsl_matrix_complex* H1 = H[1];
    gsl_complex trH1 = trace(H1);
    gsl_matrix_complex* H2 = H[2];
    gsl_complex trH2 = trace(H2);
    gsl_matrix_complex* H3 = H[3];
    gsl_complex trH3 = trace(H3);
    gsl_matrix_complex* L0 = L[0];
    gsl_matrix_complex* L1 = L[1];
    gsl_matrix_complex* L2 = L[2];
    gsl_matrix_complex* L3 = L[3];
    gsl_matrix_complex* H0H0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H0, GSL_COMPLEX_ZERO, H0H0);
    gsl_complex trH0H0 = trace(H0H0);
    gsl_matrix_complex* L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L1, GSL_COMPLEX_ZERO, L1L1);
    gsl_complex trL1L1 = trace(L1L1);
    gsl_matrix_complex* H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, H3, GSL_COMPLEX_ZERO, H3H3);
    gsl_complex trH3H3 = trace(H3H3);
    gsl_matrix_complex* L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L0, GSL_COMPLEX_ZERO, L0L0);
    gsl_complex trL0L0 = trace(L0L0);
    gsl_matrix_complex* L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, L2, GSL_COMPLEX_ZERO, L2L2);
    gsl_complex trL2L2 = trace(L2L2);
    gsl_matrix_complex* L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, L3, GSL_COMPLEX_ZERO, L3L3);
    gsl_complex trL3L3 = trace(L3L3);
    gsl_matrix_complex* H1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H1, GSL_COMPLEX_ZERO, H1H1);
    gsl_complex trH1H1 = trace(H1H1);
    gsl_matrix_complex* H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H2, GSL_COMPLEX_ZERO, H2H2);
    gsl_complex trH2H2 = trace(H2H2);
    gsl_matrix_complex_free(H0H0);
    gsl_matrix_complex_free(L1L1);
    gsl_matrix_complex_free(H3H3);
    gsl_matrix_complex_free(L0L0);
    gsl_matrix_complex_free(L2L2);
    gsl_matrix_complex_free(L3L3);
    gsl_matrix_complex_free(H1H1);
    gsl_matrix_complex_free(H2H2);
    if(control[0])
    vecS[0] = +8*GSL_REAL(gsl_complex_mul(trH1,trH1))+8*dim*GSL_REAL(trH3H3)+8*dim*GSL_REAL(trH0H0)+8*dim*GSL_REAL(trH1H1)+8*GSL_REAL(gsl_complex_mul(trH2,trH2))+8*dim*GSL_REAL(trH2H2)+8*GSL_REAL(gsl_complex_mul(trH3,trH3))+8*dim*GSL_REAL(trL3L3)+8*dim*GSL_REAL(trL0L0)+8*dim*GSL_REAL(trL1L1)+8*dim*GSL_REAL(trL2L2)+8*GSL_REAL(gsl_complex_mul(trH0,trH0));
    if(control[1])
    vecS[1] = +8*GSL_IMAG(gsl_complex_mul(trH1,trH1))+8*dim*GSL_IMAG(trH3H3)+8*dim*GSL_IMAG(trH0H0)+8*dim*GSL_IMAG(trH1H1)+8*GSL_IMAG(gsl_complex_mul(trH2,trH2))+8*dim*GSL_IMAG(trH2H2)+8*GSL_IMAG(gsl_complex_mul(trH3,trH3))+8*dim*GSL_IMAG(trL3L3)+8*dim*GSL_IMAG(trL0L0)+8*dim*GSL_IMAG(trL1L1)+8*dim*GSL_IMAG(trL2L2)+8*GSL_IMAG(gsl_complex_mul(trH0,trH0));
    if(control[2])
    vecS[2] = GSL_REAL(trH0);
    if(control[3])
    vecS[3] = GSL_REAL(trH0H0);
    if(control[4])
    vecS[4] = GSL_REAL(trH1);
    if(control[5])
    vecS[5] = GSL_REAL(trH1H1);
    if(control[6])
    vecS[4] = GSL_REAL(trH2);
    if(control[7])
    vecS[7] = GSL_REAL(trH2H2);
    if(control[8])
    vecS[8] = GSL_REAL(trH3);
    if(control[9])
    vecS[9] = GSL_REAL(trH3H3);
}


void actionD4D2t22(double* vecS, int* control)
{
    gsl_matrix_complex* H0 = H[0];
    gsl_complex trH0 = trace(H0);
    gsl_matrix_complex* H1 = H[1];
    gsl_complex trH1 = trace(H1);
    gsl_matrix_complex* H2 = H[2];
    gsl_complex trH2 = trace(H2);
    gsl_matrix_complex* H3 = H[3];
    gsl_complex trH3 = trace(H3);
    gsl_matrix_complex* L0 = L[0];
    gsl_matrix_complex* L1 = L[1];
    gsl_matrix_complex* L2 = L[2];
    gsl_matrix_complex* L3 = L[3];
    gsl_matrix_complex* H1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L1, GSL_COMPLEX_ZERO, H1L1);
    gsl_complex trH1L1 = trace(H1L1);
    gsl_matrix_complex* H2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L1, GSL_COMPLEX_ZERO, H2L1);
    gsl_complex trH2L1 = trace(H2L1);
    gsl_matrix_complex* L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L1, GSL_COMPLEX_ZERO, L1L1);
    gsl_complex trL1L1 = trace(L1L1);
    gsl_matrix_complex* H0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L2, GSL_COMPLEX_ZERO, H0L2);
    gsl_complex trH0L2 = trace(H0L2);
    gsl_matrix_complex* H0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H2, GSL_COMPLEX_ZERO, H0H2);
    gsl_complex trH0H2 = trace(H0H2);
    gsl_matrix_complex* L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L3, GSL_COMPLEX_ZERO, L0L3);
    gsl_complex trL0L3 = trace(L0L3);
    gsl_matrix_complex* H0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L3, GSL_COMPLEX_ZERO, H0L3);
    gsl_complex trH0L3 = trace(H0L3);
    gsl_matrix_complex* H2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L3, GSL_COMPLEX_ZERO, H2L3);
    gsl_complex trH2L3 = trace(H2L3);
    gsl_matrix_complex* H3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L1, GSL_COMPLEX_ZERO, H3L1);
    gsl_complex trH3L1 = trace(H3L1);
    gsl_matrix_complex* H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, H3, GSL_COMPLEX_ZERO, H3H3);
    gsl_complex trH3H3 = trace(H3H3);
    gsl_matrix_complex* L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L1, GSL_COMPLEX_ZERO, L0L1);
    gsl_complex trL0L1 = trace(L0L1);
    gsl_matrix_complex* H3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L3, GSL_COMPLEX_ZERO, H3L3);
    gsl_complex trH3L3 = trace(H3L3);
    gsl_matrix_complex* H1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H2, GSL_COMPLEX_ZERO, H1H2);
    gsl_complex trH1H2 = trace(H1H2);
    gsl_matrix_complex* H0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H3, GSL_COMPLEX_ZERO, H0H3);
    gsl_complex trH0H3 = trace(H0H3);
    gsl_matrix_complex* H0H0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H0, GSL_COMPLEX_ZERO, H0H0);
    gsl_complex trH0H0 = trace(H0H0);
    gsl_matrix_complex* L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L2, GSL_COMPLEX_ZERO, L1L2);
    gsl_complex trL1L2 = trace(L1L2);
    gsl_matrix_complex* H1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L3, GSL_COMPLEX_ZERO, H1L3);
    gsl_complex trH1L3 = trace(H1L3);
    gsl_matrix_complex* L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, L2, GSL_COMPLEX_ZERO, L2L2);
    gsl_complex trL2L2 = trace(L2L2);
    gsl_matrix_complex* H3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L0, GSL_COMPLEX_ZERO, H3L0);
    gsl_complex trH3L0 = trace(H3L0);
    gsl_matrix_complex* H1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H3, GSL_COMPLEX_ZERO, H1H3);
    gsl_complex trH1H3 = trace(H1H3);
    gsl_matrix_complex* H0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L0, GSL_COMPLEX_ZERO, H0L0);
    gsl_complex trH0L0 = trace(H0L0);
    gsl_matrix_complex* H2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H3, GSL_COMPLEX_ZERO, H2H3);
    gsl_complex trH2H3 = trace(H2H3);
    gsl_matrix_complex* H1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L0, GSL_COMPLEX_ZERO, H1L0);
    gsl_complex trH1L0 = trace(H1L0);
    gsl_matrix_complex* H0H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H1, GSL_COMPLEX_ZERO, H0H1);
    gsl_complex trH0H1 = trace(H0H1);
    gsl_matrix_complex* H2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L2, GSL_COMPLEX_ZERO, H2L2);
    gsl_complex trH2L2 = trace(H2L2);
    gsl_matrix_complex* L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, L3, GSL_COMPLEX_ZERO, L2L3);
    gsl_complex trL2L3 = trace(L2L3);
    gsl_matrix_complex* H1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H1, GSL_COMPLEX_ZERO, H1H1);
    gsl_complex trH1H1 = trace(H1H1);
    gsl_matrix_complex* L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L3, GSL_COMPLEX_ZERO, L1L3);
    gsl_complex trL1L3 = trace(L1L3);
    gsl_matrix_complex* H2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L0, GSL_COMPLEX_ZERO, H2L0);
    gsl_complex trH2L0 = trace(H2L0);
    gsl_matrix_complex* H3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L2, GSL_COMPLEX_ZERO, H3L2);
    gsl_complex trH3L2 = trace(H3L2);
    gsl_matrix_complex* H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H2, GSL_COMPLEX_ZERO, H2H2);
    gsl_complex trH2H2 = trace(H2H2);
    gsl_matrix_complex* H0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L1, GSL_COMPLEX_ZERO, H0L1);
    gsl_complex trH0L1 = trace(H0L1);
    gsl_matrix_complex* L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L2, GSL_COMPLEX_ZERO, L0L2);
    gsl_complex trL0L2 = trace(L0L2);
    gsl_matrix_complex* L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L0, GSL_COMPLEX_ZERO, L0L0);
    gsl_complex trL0L0 = trace(L0L0);
    gsl_matrix_complex* H1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L2, GSL_COMPLEX_ZERO, H1L2);
    gsl_complex trH1L2 = trace(H1L2);
    gsl_matrix_complex* L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, L3, GSL_COMPLEX_ZERO, L3L3);
    gsl_complex trL3L3 = trace(L3L3);
    gsl_matrix_complex* L3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, H3, GSL_COMPLEX_ZERO, L3H3);
    gsl_matrix_complex* H3H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, H1, GSL_COMPLEX_ZERO, H3H1);
    gsl_matrix_complex* L1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, H1, GSL_COMPLEX_ZERO, L1H1);
    gsl_matrix_complex* L1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, H2, GSL_COMPLEX_ZERO, L1H2);
    gsl_matrix_complex* L2H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, H1, GSL_COMPLEX_ZERO, L2H1);
    gsl_matrix_complex* L3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, H2, GSL_COMPLEX_ZERO, L3H2);
    gsl_matrix_complex* L1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, H3, GSL_COMPLEX_ZERO, L1H3);
    gsl_matrix_complex* L2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, H3, GSL_COMPLEX_ZERO, L2H3);
    gsl_matrix_complex* L3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, L0, GSL_COMPLEX_ZERO, L3L0);
    gsl_matrix_complex* L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, L1, GSL_COMPLEX_ZERO, L3L1);
    gsl_matrix_complex* L0H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, H1, GSL_COMPLEX_ZERO, L0H1);
    gsl_matrix_complex* H3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, H2, GSL_COMPLEX_ZERO, H3H2);
    gsl_matrix_complex* L0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, H3, GSL_COMPLEX_ZERO, L0H3);
    gsl_matrix_complex* H2H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H1, GSL_COMPLEX_ZERO, H2H1);
    gsl_matrix_complex* L2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, L0, GSL_COMPLEX_ZERO, L2L0);
    gsl_matrix_complex* L3H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, H1, GSL_COMPLEX_ZERO, L3H1);
    gsl_matrix_complex* L0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, H2, GSL_COMPLEX_ZERO, L0H2);
    gsl_matrix_complex* L2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, H2, GSL_COMPLEX_ZERO, L2H2);
    gsl_matrix_complex* L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2, L1, GSL_COMPLEX_ZERO, L2L1);
    gsl_matrix_complex* L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3, L2, GSL_COMPLEX_ZERO, L3L2);
    gsl_matrix_complex* L1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L0, GSL_COMPLEX_ZERO, L1L0);
    gsl_matrix_complex* H3L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L0L3, GSL_COMPLEX_ZERO, H3L0L3);
    gsl_complex trH3L0L3 = trace(H3L0L3);
    gsl_matrix_complex* H1L0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L0H2, GSL_COMPLEX_ZERO, H1L0H2);
    gsl_complex trH1L0H2 = trace(H1L0H2);
    gsl_matrix_complex* H0L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L3L3, GSL_COMPLEX_ZERO, H0L3L3);
    gsl_complex trH0L3L3 = trace(H0L3L3);
    gsl_matrix_complex* H2L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L0L1, GSL_COMPLEX_ZERO, H2L0L1);
    gsl_complex trH2L0L1 = trace(H2L0L1);
    gsl_matrix_complex* H3L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L0L1, GSL_COMPLEX_ZERO, H3L0L1);
    gsl_complex trH3L0L1 = trace(H3L0L1);
    gsl_matrix_complex* H1H1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H1H3, GSL_COMPLEX_ZERO, H1H1H3);
    gsl_complex trH1H1H3 = trace(H1H1H3);
    gsl_matrix_complex* H0L1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L1H1, GSL_COMPLEX_ZERO, H0L1H1);
    gsl_complex trH0L1H1 = trace(H0L1H1);
    gsl_matrix_complex* H2H2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H2H3, GSL_COMPLEX_ZERO, H2H2H3);
    gsl_complex trH2H2H3 = trace(H2H2H3);
    gsl_matrix_complex* H1L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L0L2, GSL_COMPLEX_ZERO, H1L0L2);
    gsl_complex trH1L0L2 = trace(H1L0L2);
    gsl_matrix_complex* H2L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L2L1, GSL_COMPLEX_ZERO, H2L2L1);
    gsl_complex trH2L2L1 = trace(H2L2L1);
    gsl_matrix_complex* H1H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H3H3, GSL_COMPLEX_ZERO, H1H3H3);
    gsl_complex trH1H3H3 = trace(H1H3H3);
    gsl_matrix_complex* H0L1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L1H3, GSL_COMPLEX_ZERO, H0L1H3);
    gsl_complex trH0L1H3 = trace(H0L1H3);
    gsl_matrix_complex* H2L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L3L3, GSL_COMPLEX_ZERO, H2L3L3);
    gsl_complex trH2L3L3 = trace(H2L3L3);
    gsl_matrix_complex* H0L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L2L3, GSL_COMPLEX_ZERO, H0L2L3);
    gsl_complex trH0L2L3 = trace(H0L2L3);
    gsl_matrix_complex* H2L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L0L0, GSL_COMPLEX_ZERO, H2L0L0);
    gsl_complex trH2L0L0 = trace(H2L0L0);
    gsl_matrix_complex* H2L3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L3H3, GSL_COMPLEX_ZERO, H2L3H3);
    gsl_complex trH2L3H3 = trace(H2L3H3);
    gsl_matrix_complex* H0H3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H3L1, GSL_COMPLEX_ZERO, H0H3L1);
    gsl_complex trH0H3L1 = trace(H0H3L1);
    gsl_matrix_complex* H1H1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H1H2, GSL_COMPLEX_ZERO, H1H1H2);
    gsl_complex trH1H1H2 = trace(H1H1H2);
    gsl_matrix_complex* H1H2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H2L3, GSL_COMPLEX_ZERO, H1H2L3);
    gsl_complex trH1H2L3 = trace(H1H2L3);
    gsl_matrix_complex* H0L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L2L2, GSL_COMPLEX_ZERO, H0L2L2);
    gsl_complex trH0L2L2 = trace(H0L2L2);
    gsl_matrix_complex* H1L1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L1H3, GSL_COMPLEX_ZERO, H1L1H3);
    gsl_complex trH1L1H3 = trace(H1L1H3);
    gsl_matrix_complex* H1H1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H1H1, GSL_COMPLEX_ZERO, H1H1H1);
    gsl_complex trH1H1H1 = trace(H1H1H1);
    gsl_matrix_complex* H1H2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H2L0, GSL_COMPLEX_ZERO, H1H2L0);
    gsl_complex trH1H2L0 = trace(H1H2L0);
    gsl_matrix_complex* H0H0H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H0H1, GSL_COMPLEX_ZERO, H0H0H1);
    gsl_complex trH0H0H1 = trace(H0H0H1);
    gsl_matrix_complex* H2L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L1L2, GSL_COMPLEX_ZERO, H2L1L2);
    gsl_complex trH2L1L2 = trace(H2L1L2);
    gsl_matrix_complex* H0H1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H1L0, GSL_COMPLEX_ZERO, H0H1L0);
    gsl_complex trH0H1L0 = trace(H0H1L0);
    gsl_matrix_complex* H1H3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H3L1, GSL_COMPLEX_ZERO, H1H3L1);
    gsl_complex trH1H3L1 = trace(H1H3L1);
    gsl_matrix_complex* H0L2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L2H3, GSL_COMPLEX_ZERO, H0L2H3);
    gsl_complex trH0L2H3 = trace(H0L2H3);
    gsl_matrix_complex* H0L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L0L0, GSL_COMPLEX_ZERO, H0L0L0);
    gsl_complex trH0L0L0 = trace(H0L0L0);
    gsl_matrix_complex* H0H2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H2L0, GSL_COMPLEX_ZERO, H0H2L0);
    gsl_complex trH0H2L0 = trace(H0H2L0);
    gsl_matrix_complex* H2H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H2H2, GSL_COMPLEX_ZERO, H2H2H2);
    gsl_complex trH2H2H2 = trace(H2H2H2);
    gsl_matrix_complex* H3L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L0L2, GSL_COMPLEX_ZERO, H3L0L2);
    gsl_complex trH3L0L2 = trace(H3L0L2);
    gsl_matrix_complex* H3L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L3L3, GSL_COMPLEX_ZERO, H3L3L3);
    gsl_complex trH3L3L3 = trace(H3L3L3);
    gsl_matrix_complex* H3L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L2L2, GSL_COMPLEX_ZERO, H3L2L2);
    gsl_complex trH3L2L2 = trace(H3L2L2);
    gsl_matrix_complex* H1L2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L2L0, GSL_COMPLEX_ZERO, H1L2L0);
    gsl_complex trH1L2L0 = trace(H1L2L0);
    gsl_matrix_complex* H2L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L3L1, GSL_COMPLEX_ZERO, H2L3L1);
    gsl_complex trH2L3L1 = trace(H2L3L1);
    gsl_matrix_complex* H2H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H3H3, GSL_COMPLEX_ZERO, H2H3H3);
    gsl_complex trH2H3H3 = trace(H2H3H3);
    gsl_matrix_complex* H1L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L1L1, GSL_COMPLEX_ZERO, H1L1L1);
    gsl_complex trH1L1L1 = trace(H1L1L1);
    gsl_matrix_complex* L0L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L3L2, GSL_COMPLEX_ZERO, L0L3L2);
    gsl_complex trL0L3L2 = trace(L0L3L2);
    gsl_matrix_complex* H1H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H2H2, GSL_COMPLEX_ZERO, H1H2H2);
    gsl_complex trH1H2H2 = trace(H1H2H2);
    gsl_matrix_complex* H1H3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, H3L3, GSL_COMPLEX_ZERO, H1H3L3);
    gsl_complex trH1H3L3 = trace(H1H3L3);
    gsl_matrix_complex* H1L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L3L3, GSL_COMPLEX_ZERO, H1L3L3);
    gsl_complex trH1L3L3 = trace(H1L3L3);
    gsl_matrix_complex* H0H0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H0H3, GSL_COMPLEX_ZERO, H0H0H3);
    gsl_complex trH0H0H3 = trace(H0H0H3);
    gsl_matrix_complex* H3L2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L2L0, GSL_COMPLEX_ZERO, H3L2L0);
    gsl_complex trH3L2L0 = trace(H3L2L0);
    gsl_matrix_complex* H2H3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H3L2, GSL_COMPLEX_ZERO, H2H3L2);
    gsl_complex trH2H3L2 = trace(H2H3L2);
    gsl_matrix_complex* L0L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L3L1, GSL_COMPLEX_ZERO, L0L3L1);
    gsl_complex trL0L3L1 = trace(L0L3L1);
    gsl_matrix_complex* H3H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, H3H3, GSL_COMPLEX_ZERO, H3H3H3);
    gsl_complex trH3H3H3 = trace(H3H3H3);
    gsl_matrix_complex* L1L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L3L2, GSL_COMPLEX_ZERO, L1L3L2);
    gsl_complex trL1L3L2 = trace(L1L3L2);
    gsl_matrix_complex* H3L1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L1L0, GSL_COMPLEX_ZERO, H3L1L0);
    gsl_complex trH3L1L0 = trace(H3L1L0);
    gsl_matrix_complex* H1L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L2L3, GSL_COMPLEX_ZERO, H1L2L3);
    gsl_complex trH1L2L3 = trace(H1L2L3);
    gsl_matrix_complex* L0L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L1L3, GSL_COMPLEX_ZERO, L0L1L3);
    gsl_complex trL0L1L3 = trace(L0L1L3);
    gsl_matrix_complex* H2H3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, H3L3, GSL_COMPLEX_ZERO, H2H3L3);
    gsl_complex trH2H3L3 = trace(H2H3L3);
    gsl_matrix_complex* H3L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L1L1, GSL_COMPLEX_ZERO, H3L1L1);
    gsl_complex trH3L1L1 = trace(H3L1L1);
    gsl_matrix_complex* H0H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H2H2, GSL_COMPLEX_ZERO, H0H2H2);
    gsl_complex trH0H2H2 = trace(H0H2H2);
    gsl_matrix_complex* H1L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L3L2, GSL_COMPLEX_ZERO, H1L3L2);
    gsl_complex trH1L3L2 = trace(H1L3L2);
    gsl_matrix_complex* H0L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L0L3, GSL_COMPLEX_ZERO, H0L0L3);
    gsl_complex trH0L0L3 = trace(H0L0L3);
    gsl_matrix_complex* H2L2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L2H3, GSL_COMPLEX_ZERO, H2L2H3);
    gsl_complex trH2L2H3 = trace(H2L2H3);
    gsl_matrix_complex* H1L3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L3H2, GSL_COMPLEX_ZERO, H1L3H2);
    gsl_complex trH1L3H2 = trace(H1L3H2);
    gsl_matrix_complex* H0H0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H0H2, GSL_COMPLEX_ZERO, H0H0H2);
    gsl_complex trH0H0H2 = trace(H0H0H2);
    gsl_matrix_complex* H0H3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H3L2, GSL_COMPLEX_ZERO, H0H3L2);
    gsl_complex trH0H3L2 = trace(H0H3L2);
    gsl_matrix_complex* H0L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L1L3, GSL_COMPLEX_ZERO, H0L1L3);
    gsl_complex trH0L1L3 = trace(H0L1L3);
    gsl_matrix_complex* L0L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L1L2, GSL_COMPLEX_ZERO, L0L1L2);
    gsl_complex trL0L1L2 = trace(L0L1L2);
    gsl_matrix_complex* H0H0H0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H0H0, GSL_COMPLEX_ZERO, H0H0H0);
    gsl_complex trH0H0H0 = trace(H0H0H0);
    gsl_matrix_complex* H1L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L2L1, GSL_COMPLEX_ZERO, H1L2L1);
    gsl_complex trH1L2L1 = trace(H1L2L1);
    gsl_matrix_complex* L0L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L2L1, GSL_COMPLEX_ZERO, L0L2L1);
    gsl_complex trL0L2L1 = trace(L0L2L1);
    gsl_matrix_complex* H2L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L2L2, GSL_COMPLEX_ZERO, H2L2L2);
    gsl_complex trH2L2L2 = trace(H2L2L2);
    gsl_matrix_complex* H2L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L1L1, GSL_COMPLEX_ZERO, H2L1L1);
    gsl_complex trH2L1L1 = trace(H2L1L1);
    gsl_matrix_complex* H1L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L0L0, GSL_COMPLEX_ZERO, H1L0L0);
    gsl_complex trH1L0L0 = trace(H1L0L0);
    gsl_matrix_complex* H1L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L1L2, GSL_COMPLEX_ZERO, H1L1L2);
    gsl_complex trH1L1L2 = trace(H1L1L2);
    gsl_matrix_complex* H0L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L3L1, GSL_COMPLEX_ZERO, H0L3L1);
    gsl_complex trH0L3L1 = trace(H0L3L1);
    gsl_matrix_complex* H0H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H3H3, GSL_COMPLEX_ZERO, H0H3H3);
    gsl_complex trH0H3H3 = trace(H0H3H3);
    gsl_matrix_complex* H0L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L3L2, GSL_COMPLEX_ZERO, H0L3L2);
    gsl_complex trH0L3L2 = trace(H0L3L2);
    gsl_matrix_complex* H1L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L2L2, GSL_COMPLEX_ZERO, H1L2L2);
    gsl_complex trH1L2L2 = trace(H1L2L2);
    gsl_matrix_complex* H3L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L0L0, GSL_COMPLEX_ZERO, H3L0L0);
    gsl_complex trH3L0L0 = trace(H3L0L0);
    gsl_matrix_complex* H2L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L1L3, GSL_COMPLEX_ZERO, H2L1L3);
    gsl_complex trH2L1L3 = trace(H2L1L3);
    gsl_matrix_complex* H0L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L1L1, GSL_COMPLEX_ZERO, H0L1L1);
    gsl_complex trH0L1L1 = trace(H0L1L1);
    gsl_matrix_complex* H0L3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L3L0, GSL_COMPLEX_ZERO, H0L3L0);
    gsl_complex trH0L3L0 = trace(H0L3L0);
    gsl_matrix_complex* H2L1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2, L1L0, GSL_COMPLEX_ZERO, H2L1L0);
    gsl_complex trH2L1L0 = trace(H2L1L0);
    gsl_matrix_complex* L1L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1, L2L3, GSL_COMPLEX_ZERO, L1L2L3);
    gsl_complex trL1L2L3 = trace(L1L2L3);
    gsl_matrix_complex* H0H1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H1H1, GSL_COMPLEX_ZERO, H0H1H1);
    gsl_complex trH0H1H1 = trace(H0H1H1);
    gsl_matrix_complex* H0L2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L2H2, GSL_COMPLEX_ZERO, H0L2H2);
    gsl_complex trH0L2H2 = trace(H0L2H2);
    gsl_matrix_complex* L0L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0, L2L3, GSL_COMPLEX_ZERO, L0L2L3);
    gsl_complex trL0L2L3 = trace(L0L2L3);
    gsl_matrix_complex* H0L0H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L0H1, GSL_COMPLEX_ZERO, H0L0H1);
    gsl_complex trH0L0H1 = trace(H0L0H1);
    gsl_matrix_complex* H0H1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H1L1, GSL_COMPLEX_ZERO, H0H1L1);
    gsl_complex trH0H1L1 = trace(H0H1L1);
    gsl_matrix_complex* H0L0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, L0H2, GSL_COMPLEX_ZERO, H0L0H2);
    gsl_complex trH0L0H2 = trace(H0L0H2);
    gsl_matrix_complex* H0H2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0, H2L2, GSL_COMPLEX_ZERO, H0H2L2);
    gsl_complex trH0H2L2 = trace(H0H2L2);
    gsl_matrix_complex* H1L3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1, L3H3, GSL_COMPLEX_ZERO, H1L3H3);
    gsl_complex trH1L3H3 = trace(H1L3H3);
    gsl_matrix_complex* H3L3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3, L3L0, GSL_COMPLEX_ZERO, H3L3L0);
    gsl_complex trH3L3L0 = trace(H3L3L0);
    gsl_matrix_complex* H0H0H1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, H1H1, GSL_COMPLEX_ZERO, H0H0H1H1);
    gsl_complex trH0H0H1H1 = trace(H0H0H1H1);
    gsl_matrix_complex* H1H3L2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H3, L2L0, GSL_COMPLEX_ZERO, H1H3L2L0);
    gsl_complex trH1H3L2L0 = trace(H1H3L2L0);
    gsl_matrix_complex* L0L1L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, L0L1, L0L1, GSL_COMPLEX_ZERO, L0L1L0L1);
    gsl_complex trL0L1L0L1 = trace(L0L1L0L1);
    gsl_matrix_complex* H3H3L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3H3, L0L0, GSL_COMPLEX_ZERO, H3H3L0L0);
    gsl_complex trH3H3L0L0 = trace(H3H3L0L0);
    gsl_matrix_complex* H1H3H2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H3, H2L3, GSL_COMPLEX_ZERO, H1H3H2L3);
    gsl_complex trH1H3H2L3 = trace(H1H3H2L3);
    gsl_matrix_complex* H0L1H3H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, H3H1, GSL_COMPLEX_ZERO, H0L1H3H1);
    gsl_complex trH0L1H3H1 = trace(H0L1H3H1);
    gsl_matrix_complex* H0H3L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, L0L3, GSL_COMPLEX_ZERO, H0H3L0L3);
    gsl_complex trH0H3L0L3 = trace(H0H3L0L3);
    gsl_matrix_complex* H1L3H3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L3, H3H2, GSL_COMPLEX_ZERO, H1L3H3H2);
    gsl_complex trH1L3H3H2 = trace(H1L3H3H2);
    gsl_matrix_complex* H0H2L0H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, L0H1, GSL_COMPLEX_ZERO, H0H2L0H1);
    gsl_complex trH0H2L0H1 = trace(H0H2L0H1);
    gsl_matrix_complex* H1H2H3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H2, H3L3, GSL_COMPLEX_ZERO, H1H2H3L3);
    gsl_complex trH1H2H3L3 = trace(H1H2H3L3);
    gsl_matrix_complex* H2L3H2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L3, H2L3, GSL_COMPLEX_ZERO, H2L3H2L3);
    gsl_complex trH2L3H2L3 = trace(H2L3H2L3);
    gsl_matrix_complex* H0H1H3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, H3L1, GSL_COMPLEX_ZERO, H0H1H3L1);
    gsl_complex trH0H1H3L1 = trace(H0H1H3L1);
    gsl_matrix_complex* L2L3L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, L2L3, L2L3, GSL_COMPLEX_ZERO, L2L3L2L3);
    gsl_complex trL2L3L2L3 = trace(L2L3L2L3);
    gsl_matrix_complex* H0L1L3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, L3H2, GSL_COMPLEX_ZERO, H0L1L3H2);
    gsl_complex trH0L1L3H2 = trace(H0L1L3H2);
    gsl_matrix_complex* H1L1H1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L1, H1L1, GSL_COMPLEX_ZERO, H1L1H1L1);
    gsl_complex trH1L1H1L1 = trace(H1L1H1L1);
    gsl_matrix_complex* H0L2L1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, L1L0, GSL_COMPLEX_ZERO, H0L2L1L0);
    gsl_complex trH0L2L1L0 = trace(H0L2L1L0);
    gsl_matrix_complex* H0L2H2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, H2H3, GSL_COMPLEX_ZERO, H0L2H2H3);
    gsl_complex trH0L2H2H3 = trace(H0L2H2H3);
    gsl_matrix_complex* H2H2L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2H2, L1L1, GSL_COMPLEX_ZERO, H2H2L1L1);
    gsl_complex trH2H2L1L1 = trace(H2H2L1L1);
    gsl_matrix_complex* H3L3H3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L3, H3L3, GSL_COMPLEX_ZERO, H3L3H3L3);
    gsl_complex trH3L3H3L3 = trace(H3L3H3L3);
    gsl_matrix_complex* H3L3L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L3, L2L1, GSL_COMPLEX_ZERO, H3L3L2L1);
    gsl_complex trH3L3L2L1 = trace(H3L3L2L1);
    gsl_matrix_complex* H1L0L2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L0, L2H3, GSL_COMPLEX_ZERO, H1L0L2H3);
    gsl_complex trH1L0L2H3 = trace(H1L0L2H3);
    gsl_matrix_complex* H1L1L2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L1, L2H2, GSL_COMPLEX_ZERO, H1L1L2H2);
    gsl_complex trH1L1L2H2 = trace(H1L1L2H2);
    gsl_matrix_complex* H1L0L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L0, L3L1, GSL_COMPLEX_ZERO, H1L0L3L1);
    gsl_complex trH1L0L3L1 = trace(H1L0L3L1);
    gsl_matrix_complex* H1H3L3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H3, L3H2, GSL_COMPLEX_ZERO, H1H3L3H2);
    gsl_complex trH1H3L3H2 = trace(H1H3L3H2);
    gsl_matrix_complex* H0H3L1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, L1H1, GSL_COMPLEX_ZERO, H0H3L1H1);
    gsl_complex trH0H3L1H1 = trace(H0H3L1H1);
    gsl_matrix_complex* H0H1H2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, H2L0, GSL_COMPLEX_ZERO, H0H1H2L0);
    gsl_complex trH0H1H2L0 = trace(H0H1H2L0);
    gsl_matrix_complex* L0L0L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0L0, L1L1, GSL_COMPLEX_ZERO, L0L0L1L1);
    gsl_complex trL0L0L1L1 = trace(L0L0L1L1);
    gsl_matrix_complex* H0L0L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, L1L2, GSL_COMPLEX_ZERO, H0L0L1L2);
    gsl_complex trH0L0L1L2 = trace(H0L0L1L2);
    gsl_matrix_complex* H0L3H1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, H1L2, GSL_COMPLEX_ZERO, H0L3H1L2);
    gsl_complex trH0L3H1L2 = trace(H0L3H1L2);
    gsl_matrix_complex* H3L1L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L1, L2L3, GSL_COMPLEX_ZERO, H3L1L2L3);
    gsl_complex trH3L1L2L3 = trace(H3L1L2L3);
    gsl_matrix_complex* H0L1H1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, H1H3, GSL_COMPLEX_ZERO, H0L1H1H3);
    gsl_complex trH0L1H1H3 = trace(H0L1H1H3);
    gsl_matrix_complex* H0H0H0H0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, H0H0, GSL_COMPLEX_ZERO, H0H0H0H0);
    gsl_complex trH0H0H0H0 = trace(H0H0H0H0);
    gsl_matrix_complex* H0H2L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, L1L3, GSL_COMPLEX_ZERO, H0H2L1L3);
    gsl_complex trH0H2L1L3 = trace(H0H2L1L3);
    gsl_matrix_complex* H1L0H1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L0, H1L0, GSL_COMPLEX_ZERO, H1L0H1L0);
    gsl_complex trH1L0H1L0 = trace(H1L0H1L0);
    gsl_matrix_complex* L0L3L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, L0L3, L0L3, GSL_COMPLEX_ZERO, L0L3L0L3);
    gsl_complex trL0L3L0L3 = trace(L0L3L0L3);
    gsl_matrix_complex* H2L1L0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L1, L0H3, GSL_COMPLEX_ZERO, H2L1L0H3);
    gsl_complex trH2L1L0H3 = trace(H2L1L0H3);
    gsl_matrix_complex* H0L0L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, L2L1, GSL_COMPLEX_ZERO, H0L0L2L1);
    gsl_complex trH0L0L2L1 = trace(H0L0L2L1);
    gsl_matrix_complex* H0H3L3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, L3L0, GSL_COMPLEX_ZERO, H0H3L3L0);
    gsl_complex trH0H3L3L0 = trace(H0H3L3L0);
    gsl_matrix_complex* H1L3L1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L3, L1L0, GSL_COMPLEX_ZERO, H1L3L1L0);
    gsl_complex trH1L3L1L0 = trace(H1L3L1L0);
    gsl_matrix_complex* H1H1L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, L1L1, GSL_COMPLEX_ZERO, H1H1L1L1);
    gsl_complex trH1H1L1L1 = trace(H1H1L1L1);
    gsl_matrix_complex* H0L0H2H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, H2H1, GSL_COMPLEX_ZERO, H0L0H2H1);
    gsl_complex trH0L0H2H1 = trace(H0L0H2H1);
    gsl_matrix_complex* H0L1L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, L0L2, GSL_COMPLEX_ZERO, H0L1L0L2);
    gsl_complex trH0L1L0L2 = trace(H0L1L0L2);
    gsl_matrix_complex* H1H2L2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H2, L2L1, GSL_COMPLEX_ZERO, H1H2L2L1);
    gsl_complex trH1H2L2L1 = trace(H1H2L2L1);
    gsl_matrix_complex* H2L0H3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L0, H3L1, GSL_COMPLEX_ZERO, H2L0H3L1);
    gsl_complex trH2L0H3L1 = trace(H2L0H3L1);
    gsl_matrix_complex* H0H0L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, L1L1, GSL_COMPLEX_ZERO, H0H0L1L1);
    gsl_complex trH0H0L1L1 = trace(H0H0L1L1);
    gsl_matrix_complex* H2L0L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L0, L3L2, GSL_COMPLEX_ZERO, H2L0L3L2);
    gsl_complex trH2L0L3L2 = trace(H2L0L3L2);
    gsl_matrix_complex* H1L2H1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L2, H1L2, GSL_COMPLEX_ZERO, H1L2H1L2);
    gsl_complex trH1L2H1L2 = trace(H1L2H1L2);
    gsl_matrix_complex* H0L1H0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, H0L1, GSL_COMPLEX_ZERO, H0L1H0L1);
    gsl_complex trH0L1H0L1 = trace(H0L1H0L1);
    gsl_matrix_complex* H2L0H2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L0, H2L0, GSL_COMPLEX_ZERO, H2L0H2L0);
    gsl_complex trH2L0H2L0 = trace(H2L0H2L0);
    gsl_matrix_complex* H0H0L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, L3L3, GSL_COMPLEX_ZERO, H0H0L3L3);
    gsl_complex trH0H0L3L3 = trace(H0H0L3L3);
    gsl_matrix_complex* H2L2H2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L2, H2L2, GSL_COMPLEX_ZERO, H2L2H2L2);
    gsl_complex trH2L2H2L2 = trace(H2L2H2L2);
    gsl_matrix_complex* H0L1L2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, L2L0, GSL_COMPLEX_ZERO, H0L1L2L0);
    gsl_complex trH0L1L2L0 = trace(H0L1L2L0);
    gsl_matrix_complex* H1L1L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L1, L0L3, GSL_COMPLEX_ZERO, H1L1L0L3);
    gsl_complex trH1L1L0L3 = trace(H1L1L0L3);
    gsl_matrix_complex* L0L0L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0L0, L3L3, GSL_COMPLEX_ZERO, L0L0L3L3);
    gsl_complex trL0L0L3L3 = trace(L0L0L3L3);
    gsl_matrix_complex* H1H1H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, H3H3, GSL_COMPLEX_ZERO, H1H1H3H3);
    gsl_complex trH1H1H3H3 = trace(H1H1H3H3);
    gsl_matrix_complex* H2H2L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2H2, L3L3, GSL_COMPLEX_ZERO, H2H2L3L3);
    gsl_complex trH2H2L3L3 = trace(H2H2L3L3);
    gsl_matrix_complex* H3H3L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3H3, L1L1, GSL_COMPLEX_ZERO, H3H3L1L1);
    gsl_complex trH3H3L1L1 = trace(H3H3L1L1);
    gsl_matrix_complex* L1L1L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1L1, L2L2, GSL_COMPLEX_ZERO, L1L1L2L2);
    gsl_complex trL1L1L2L2 = trace(L1L1L2L2);
    gsl_matrix_complex* L1L1L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1L1, L3L3, GSL_COMPLEX_ZERO, L1L1L3L3);
    gsl_complex trL1L1L3L3 = trace(L1L1L3L3);
    gsl_matrix_complex* H3L2H3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L2, H3L2, GSL_COMPLEX_ZERO, H3L2H3L2);
    gsl_complex trH3L2H3L2 = trace(H3L2H3L2);
    gsl_matrix_complex* H0H1L0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, L0H2, GSL_COMPLEX_ZERO, H0H1L0H2);
    gsl_complex trH0H1L0H2 = trace(H0H1L0H2);
    gsl_matrix_complex* H0L0H1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, H1H2, GSL_COMPLEX_ZERO, H0L0H1H2);
    gsl_complex trH0L0H1H2 = trace(H0L0H1H2);
    gsl_matrix_complex* H3L2L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L2, L1L3, GSL_COMPLEX_ZERO, H3L2L1L3);
    gsl_complex trH3L2L1L3 = trace(H3L2L1L3);
    gsl_matrix_complex* H2H3H2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2H3, H2H3, GSL_COMPLEX_ZERO, H2H3H2H3);
    gsl_complex trH2H3H2H3 = trace(H2H3H2H3);
    gsl_matrix_complex* H2H3L1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2H3, L1L0, GSL_COMPLEX_ZERO, H2H3L1L0);
    gsl_complex trH2H3L1L0 = trace(H2H3L1L0);
    gsl_matrix_complex* H1H2L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H2, L1L2, GSL_COMPLEX_ZERO, H1H2L1L2);
    gsl_complex trH1H2L1L2 = trace(H1H2L1L2);
    gsl_matrix_complex* L1L2L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, L1L2, L1L2, GSL_COMPLEX_ZERO, L1L2L1L2);
    gsl_complex trL1L2L1L2 = trace(L1L2L1L2);
    gsl_matrix_complex* H2L0L1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L0, L1H3, GSL_COMPLEX_ZERO, H2L0L1H3);
    gsl_complex trH2L0L1H3 = trace(H2L0L1H3);
    gsl_matrix_complex* H0H1L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, L2L3, GSL_COMPLEX_ZERO, H0H1L2L3);
    gsl_complex trH0H1L2L3 = trace(H0H1L2L3);
    gsl_matrix_complex* H0L2H1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, H1L3, GSL_COMPLEX_ZERO, H0L2H1L3);
    gsl_complex trH0L2H1L3 = trace(H0L2H1L3);
    gsl_matrix_complex* H0H2H3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, H3L2, GSL_COMPLEX_ZERO, H0H2H3L2);
    gsl_complex trH0H2H3L2 = trace(H0H2H3L2);
    gsl_matrix_complex* H0H2L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, L3L1, GSL_COMPLEX_ZERO, H0H2L3L1);
    gsl_complex trH0H2L3L1 = trace(H0H2L3L1);
    gsl_matrix_complex* H1L2L0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L2, L0H3, GSL_COMPLEX_ZERO, H1L2L0H3);
    gsl_complex trH1L2L0H3 = trace(H1L2L0H3);
    gsl_matrix_complex* H0H3H1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, H1L1, GSL_COMPLEX_ZERO, H0H3H1L1);
    gsl_complex trH0H3H1L1 = trace(H0H3H1L1);
    gsl_matrix_complex* H2L3L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L3, L0L2, GSL_COMPLEX_ZERO, H2L3L0L2);
    gsl_complex trH2L3L0L2 = trace(H2L3L0L2);
    gsl_matrix_complex* H3L1H3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L1, H3L1, GSL_COMPLEX_ZERO, H3L1H3L1);
    gsl_complex trH3L1H3L1 = trace(H3L1H3L1);
    gsl_matrix_complex* H1L3L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L3, L0L1, GSL_COMPLEX_ZERO, H1L3L0L1);
    gsl_complex trH1L3L0L1 = trace(H1L3L0L1);
    gsl_matrix_complex* H1L0L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L0, L1L3, GSL_COMPLEX_ZERO, H1L0L1L3);
    gsl_complex trH1L0L1L3 = trace(H1L0L1L3);
    gsl_matrix_complex* H0L3H2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, H2L1, GSL_COMPLEX_ZERO, H0L3H2L1);
    gsl_complex trH0L3H2L1 = trace(H0L3H2L1);
    gsl_matrix_complex* H1L2L1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L2, L1H2, GSL_COMPLEX_ZERO, H1L2L1H2);
    gsl_complex trH1L2L1H2 = trace(H1L2L1H2);
    gsl_matrix_complex* H1H3H1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H3, H1H3, GSL_COMPLEX_ZERO, H1H3H1H3);
    gsl_complex trH1H3H1H3 = trace(H1H3H1H3);
    gsl_matrix_complex* H3L3L1L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L3, L1L2, GSL_COMPLEX_ZERO, H3L3L1L2);
    gsl_complex trH3L3L1L2 = trace(H3L3L1L2);
    gsl_matrix_complex* H0H0L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, L0L0, GSL_COMPLEX_ZERO, H0H0L0L0);
    gsl_complex trH0H0L0L0 = trace(H0H0L0L0);
    gsl_matrix_complex* H0L2H3H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, H3H2, GSL_COMPLEX_ZERO, H0L2H3H2);
    gsl_complex trH0L2H3H2 = trace(H0L2H3H2);
    gsl_matrix_complex* H0H1H0H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, H0H1, GSL_COMPLEX_ZERO, H0H1H0H1);
    gsl_complex trH0H1H0H1 = trace(H0H1H0H1);
    gsl_matrix_complex* L0L2L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, L0L2, L0L2, GSL_COMPLEX_ZERO, L0L2L0L2);
    gsl_complex trL0L2L0L2 = trace(L0L2L0L2);
    gsl_matrix_complex* H2L1H2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L1, H2L1, GSL_COMPLEX_ZERO, H2L1H2L1);
    gsl_complex trH2L1H2L1 = trace(H2L1H2L1);
    gsl_matrix_complex* H2L2L3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L2, L3L0, GSL_COMPLEX_ZERO, H2L2L3L0);
    gsl_complex trH2L2L3L0 = trace(H2L2L3L0);
    gsl_matrix_complex* H0H2L2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, L2H3, GSL_COMPLEX_ZERO, H0H2L2H3);
    gsl_complex trH0H2L2H3 = trace(H0H2L2H3);
    gsl_matrix_complex* H1H1H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, H2H2, GSL_COMPLEX_ZERO, H1H1H2H2);
    gsl_complex trH1H1H2H2 = trace(H1H1H2H2);
    gsl_matrix_complex* L1L3L1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, L1L3, L1L3, GSL_COMPLEX_ZERO, L1L3L1L3);
    gsl_complex trL1L3L1L3 = trace(L1L3L1L3);
    gsl_matrix_complex* H0L0H0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, H0L0, GSL_COMPLEX_ZERO, H0L0H0L0);
    gsl_complex trH0L0H0L0 = trace(H0L0H0L0);
    gsl_matrix_complex* H3L2L3L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L2, L3L1, GSL_COMPLEX_ZERO, H3L2L3L1);
    gsl_complex trH3L2L3L1 = trace(H3L2L3L1);
    gsl_matrix_complex* H0L0H3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, H3L3, GSL_COMPLEX_ZERO, H0L0H3L3);
    gsl_complex trH0L0H3L3 = trace(H0L0H3L3);
    gsl_matrix_complex* H1L2H2L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L2, H2L1, GSL_COMPLEX_ZERO, H1L2H2L1);
    gsl_complex trH1L2H2L1 = trace(H1L2H2L1);
    gsl_matrix_complex* H0L1H2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L1, H2L3, GSL_COMPLEX_ZERO, H0L1H2L3);
    gsl_complex trH0L1H2L3 = trace(H0L1H2L3);
    gsl_matrix_complex* H1H1H1H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, H1H1, GSL_COMPLEX_ZERO, H1H1H1H1);
    gsl_complex trH1H1H1H1 = trace(H1H1H1H1);
    gsl_matrix_complex* L2L2L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2L2, L3L3, GSL_COMPLEX_ZERO, L2L2L3L3);
    gsl_complex trL2L2L3L3 = trace(L2L2L3L3);
    gsl_matrix_complex* H1L3H1L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L3, H1L3, GSL_COMPLEX_ZERO, H1L3H1L3);
    gsl_complex trH1L3H1L3 = trace(H1L3H1L3);
    gsl_matrix_complex* H1H3L0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H3, L0L2, GSL_COMPLEX_ZERO, H1H3L0L2);
    gsl_complex trH1H3L0L2 = trace(H1H3L0L2);
    gsl_matrix_complex* H1L0H3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L0, H3L2, GSL_COMPLEX_ZERO, H1L0H3L2);
    gsl_complex trH1L0H3L2 = trace(H1L0H3L2);
    gsl_matrix_complex* H3H3L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3H3, L3L3, GSL_COMPLEX_ZERO, H3H3L3L3);
    gsl_complex trH3H3L3L3 = trace(H3H3L3L3);
    gsl_matrix_complex* H1L3H2H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L3, H2H3, GSL_COMPLEX_ZERO, H1L3H2H3);
    gsl_complex trH1L3H2H3 = trace(H1L3H2H3);
    gsl_matrix_complex* H1H2L3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H2, L3H3, GSL_COMPLEX_ZERO, H1H2L3H3);
    gsl_complex trH1H2L3H3 = trace(H1H2L3H3);
    gsl_matrix_complex* L0L0L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0L0, L2L2, GSL_COMPLEX_ZERO, L0L0L2L2);
    gsl_complex trL0L0L2L2 = trace(L0L0L2L2);
    gsl_matrix_complex* H0H3H0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, H0H3, GSL_COMPLEX_ZERO, H0H3H0H3);
    gsl_complex trH0H3H0H3 = trace(H0H3H0H3);
    gsl_matrix_complex* H0L3L2H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, L2H1, GSL_COMPLEX_ZERO, H0L3L2H1);
    gsl_complex trH0L3L2H1 = trace(H0L3L2H1);
    gsl_matrix_complex* H1L2H3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L2, H3L0, GSL_COMPLEX_ZERO, H1L2H3L0);
    gsl_complex trH1L2H3L0 = trace(H1L2H3L0);
    gsl_matrix_complex* H0L2L3H1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, L3H1, GSL_COMPLEX_ZERO, H0L2L3H1);
    gsl_complex trH0L2L3H1 = trace(H0L2L3H1);
    gsl_matrix_complex* L0L0L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L0L0, L0L0, GSL_COMPLEX_ZERO, L0L0L0L0);
    gsl_complex trL0L0L0L0 = trace(L0L0L0L0);
    gsl_matrix_complex* H0H1L1H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, L1H3, GSL_COMPLEX_ZERO, H0H1L1H3);
    gsl_complex trH0H1L1H3 = trace(H0H1L1H3);
    gsl_matrix_complex* H0H0H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, H3H3, GSL_COMPLEX_ZERO, H0H0H3H3);
    gsl_complex trH0H0H3H3 = trace(H0H0H3H3);
    gsl_matrix_complex* H1L1L3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L1, L3L0, GSL_COMPLEX_ZERO, H1L1L3L0);
    gsl_complex trH1L1L3L0 = trace(H1L1L3L0);
    gsl_matrix_complex* H1H1L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, L3L3, GSL_COMPLEX_ZERO, H1H1L3L3);
    gsl_complex trH1H1L3L3 = trace(H1H1L3L3);
    gsl_matrix_complex* L2L2L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L2L2, L2L2, GSL_COMPLEX_ZERO, L2L2L2L2);
    gsl_complex trL2L2L2L2 = trace(L2L2L2L2);
    gsl_matrix_complex* H2H3L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2H3, L0L1, GSL_COMPLEX_ZERO, H2H3L0L1);
    gsl_complex trH2H3L0L1 = trace(H2H3L0L1);
    gsl_matrix_complex* H1L1H2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1L1, H2L2, GSL_COMPLEX_ZERO, H1L1H2L2);
    gsl_complex trH1L1H2L2 = trace(H1L1H2L2);
    gsl_matrix_complex* H2H2L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2H2, L2L2, GSL_COMPLEX_ZERO, H2H2L2L2);
    gsl_complex trH2H2L2L2 = trace(H2H2L2L2);
    gsl_matrix_complex* H2L2L0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L2, L0L3, GSL_COMPLEX_ZERO, H2L2L0L3);
    gsl_complex trH2L2L0L3 = trace(H2L2L0L3);
    gsl_matrix_complex* H3H3H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3H3, H3H3, GSL_COMPLEX_ZERO, H3H3H3H3);
    gsl_complex trH3H3H3H3 = trace(H3H3H3H3);
    gsl_matrix_complex* H0L3H0L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, H0L3, GSL_COMPLEX_ZERO, H0L3H0L3);
    gsl_complex trH0L3H0L3 = trace(H0L3H0L3);
    gsl_matrix_complex* H2H2L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2H2, L0L0, GSL_COMPLEX_ZERO, H2H2L0L0);
    gsl_complex trH2H2L0L0 = trace(H2H2L0L0);
    gsl_matrix_complex* H0H2H0H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, H0H2, GSL_COMPLEX_ZERO, H0H2H0H2);
    gsl_complex trH0H2H0H2 = trace(H0H2H0H2);
    gsl_matrix_complex* H2H2H3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2H2, H3H3, GSL_COMPLEX_ZERO, H2H2H3H3);
    gsl_complex trH2H2H3H3 = trace(H2H2H3H3);
    gsl_matrix_complex* H0L3H3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, H3L0, GSL_COMPLEX_ZERO, H0L3H3L0);
    gsl_complex trH0L3H3L0 = trace(H0L3H3L0);
    gsl_matrix_complex* H0L2H0L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, H0L2, GSL_COMPLEX_ZERO, H0L2H0L2);
    gsl_complex trH0L2H0L2 = trace(H0L2H0L2);
    gsl_matrix_complex* H0L3L1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, L1H2, GSL_COMPLEX_ZERO, H0L3L1H2);
    gsl_complex trH0L3L1H2 = trace(H0L3L1H2);
    gsl_matrix_complex* H0H0H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, H2H2, GSL_COMPLEX_ZERO, H0H0H2H2);
    gsl_complex trH0H0H2H2 = trace(H0H0H2H2);
    gsl_matrix_complex* H0H3L2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, L2H2, GSL_COMPLEX_ZERO, H0H3L2H2);
    gsl_complex trH0H3L2H2 = trace(H0H3L2H2);
    gsl_matrix_complex* H0L3L0H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L3, L0H3, GSL_COMPLEX_ZERO, H0L3L0H3);
    gsl_complex trH0L3L0H3 = trace(H0L3L0H3);
    gsl_matrix_complex* H2L0L2L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L0, L2L3, GSL_COMPLEX_ZERO, H2L0L2L3);
    gsl_complex trH2L0L2L3 = trace(H2L0L2L3);
    gsl_matrix_complex* H3L1L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L1, L3L2, GSL_COMPLEX_ZERO, H3L1L3L2);
    gsl_complex trH3L1L3L2 = trace(H3L1L3L2);
    gsl_matrix_complex* H1H1L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, L2L2, GSL_COMPLEX_ZERO, H1H1L2L2);
    gsl_complex trH1H1L2L2 = trace(H1H1L2L2);
    gsl_matrix_complex* H2L3L2L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L3, L2L0, GSL_COMPLEX_ZERO, H2L3L2L0);
    gsl_complex trH2L3L2L0 = trace(H2L3L2L0);
    gsl_matrix_complex* H0H3H2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H3, H2L2, GSL_COMPLEX_ZERO, H0H3H2L2);
    gsl_complex trH0H3H2L2 = trace(H0H3H2L2);
    gsl_matrix_complex* H0L2L0L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L2, L0L1, GSL_COMPLEX_ZERO, H0L2L0L1);
    gsl_complex trH0L2L0L1 = trace(H0L2L0L1);
    gsl_matrix_complex* H0H1L3L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H1, L3L2, GSL_COMPLEX_ZERO, H0H1L3L2);
    gsl_complex trH0H1L3L2 = trace(H0H1L3L2);
    gsl_matrix_complex* H1H2H1H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H1H2, H1H2, GSL_COMPLEX_ZERO, H1H2H1H2);
    gsl_complex trH1H2H1H2 = trace(H1H2H1H2);
    gsl_matrix_complex* H2L1H3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H2L1, H3L0, GSL_COMPLEX_ZERO, H2L1H3L0);
    gsl_complex trH2L1H3L0 = trace(H2L1H3L0);
    gsl_matrix_complex* H0H2H1L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0H2, H1L0, GSL_COMPLEX_ZERO, H0H2H1L0);
    gsl_complex trH0H2H1L0 = trace(H0H2H1L0);
    gsl_matrix_complex* H0L0L3H3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H0L0, L3H3, GSL_COMPLEX_ZERO, H0L0L3H3);
    gsl_complex trH0L0L3H3 = trace(H0L0L3H3);
    gsl_matrix_complex* L1L1L1L1 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L1L1, L1L1, GSL_COMPLEX_ZERO, L1L1L1L1);
    gsl_complex trL1L1L1L1 = trace(L1L1L1L1);
    gsl_matrix_complex* H3L0H3L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zgemm(CblasNoTrans, CblasNoTrans, GSL_COMPLEX_ONE, H3L0, H3L0, GSL_COMPLEX_ZERO, H3L0H3L0);
    gsl_complex trH3L0H3L0 = trace(H3L0H3L0);
    gsl_matrix_complex* L3L3L3L3 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, L3L3, L3L3, GSL_COMPLEX_ZERO, L3L3L3L3);
    gsl_complex trL3L3L3L3 = trace(L3L3L3L3);
    gsl_matrix_complex* H3H3L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H3H3, L2L2, GSL_COMPLEX_ZERO, H3H3L2L2);
    gsl_complex trH3H3L2L2 = trace(H3H3L2L2);
    gsl_matrix_complex* H2H2H2H2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H2H2, H2H2, GSL_COMPLEX_ZERO, H2H2H2H2);
    gsl_complex trH2H2H2H2 = trace(H2H2H2H2);
    gsl_matrix_complex* H0H0L2L2 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H0H0, L2L2, GSL_COMPLEX_ZERO, H0H0L2L2);
    gsl_complex trH0H0L2L2 = trace(H0H0L2L2);
    gsl_matrix_complex* H1H1L0L0 = gsl_matrix_complex_calloc(dim, dim);
    gsl_blas_zhemm(CblasLeft, CblasUpper, GSL_COMPLEX_ONE, H1H1, L0L0, GSL_COMPLEX_ZERO, H1H1L0L0);
    gsl_complex trH1H1L0L0 = trace(H1H1L0L0);
    gsl_matrix_complex_free(H1L1);
    gsl_matrix_complex_free(H2L1);
    gsl_matrix_complex_free(L1L1);
    gsl_matrix_complex_free(H0L2);
    gsl_matrix_complex_free(H0H2);
    gsl_matrix_complex_free(L0L3);
    gsl_matrix_complex_free(H0L3);
    gsl_matrix_complex_free(H2L3);
    gsl_matrix_complex_free(H3L1);
    gsl_matrix_complex_free(H3H3);
    gsl_matrix_complex_free(L0L1);
    gsl_matrix_complex_free(H3L3);
    gsl_matrix_complex_free(H1H2);
    gsl_matrix_complex_free(H0H3);
    gsl_matrix_complex_free(H0H0);
    gsl_matrix_complex_free(L1L2);
    gsl_matrix_complex_free(H1L3);
    gsl_matrix_complex_free(L2L2);
    gsl_matrix_complex_free(H3L0);
    gsl_matrix_complex_free(H1H3);
    gsl_matrix_complex_free(H0L0);
    gsl_matrix_complex_free(H2H3);
    gsl_matrix_complex_free(H1L0);
    gsl_matrix_complex_free(H0H1);
    gsl_matrix_complex_free(H2L2);
    gsl_matrix_complex_free(L2L3);
    gsl_matrix_complex_free(H1H1);
    gsl_matrix_complex_free(L1L3);
    gsl_matrix_complex_free(H2L0);
    gsl_matrix_complex_free(H3L2);
    gsl_matrix_complex_free(H2H2);
    gsl_matrix_complex_free(H0L1);
    gsl_matrix_complex_free(L0L2);
    gsl_matrix_complex_free(L0L0);
    gsl_matrix_complex_free(H1L2);
    gsl_matrix_complex_free(L3L3);
    gsl_matrix_complex_free(L3H3);
    gsl_matrix_complex_free(H3H1);
    gsl_matrix_complex_free(L1H1);
    gsl_matrix_complex_free(L1H2);
    gsl_matrix_complex_free(L2H1);
    gsl_matrix_complex_free(L3H2);
    gsl_matrix_complex_free(L1H3);
    gsl_matrix_complex_free(L2H3);
    gsl_matrix_complex_free(L3L0);
    gsl_matrix_complex_free(L3L1);
    gsl_matrix_complex_free(L0H1);
    gsl_matrix_complex_free(H3H2);
    gsl_matrix_complex_free(L0H3);
    gsl_matrix_complex_free(H2H1);
    gsl_matrix_complex_free(L2L0);
    gsl_matrix_complex_free(L3H1);
    gsl_matrix_complex_free(L0H2);
    gsl_matrix_complex_free(L2H2);
    gsl_matrix_complex_free(L2L1);
    gsl_matrix_complex_free(L3L2);
    gsl_matrix_complex_free(L1L0);
    gsl_matrix_complex_free(H3L0L3);
    gsl_matrix_complex_free(H1L0H2);
    gsl_matrix_complex_free(H0L3L3);
    gsl_matrix_complex_free(H2L0L1);
    gsl_matrix_complex_free(H3L0L1);
    gsl_matrix_complex_free(H1H1H3);
    gsl_matrix_complex_free(H0L1H1);
    gsl_matrix_complex_free(H2H2H3);
    gsl_matrix_complex_free(H1L0L2);
    gsl_matrix_complex_free(H2L2L1);
    gsl_matrix_complex_free(H1H3H3);
    gsl_matrix_complex_free(H0L1H3);
    gsl_matrix_complex_free(H2L3L3);
    gsl_matrix_complex_free(H0L2L3);
    gsl_matrix_complex_free(H2L0L0);
    gsl_matrix_complex_free(H2L3H3);
    gsl_matrix_complex_free(H0H3L1);
    gsl_matrix_complex_free(H1H1H2);
    gsl_matrix_complex_free(H1H2L3);
    gsl_matrix_complex_free(H0L2L2);
    gsl_matrix_complex_free(H1L1H3);
    gsl_matrix_complex_free(H1H1H1);
    gsl_matrix_complex_free(H1H2L0);
    gsl_matrix_complex_free(H0H0H1);
    gsl_matrix_complex_free(H2L1L2);
    gsl_matrix_complex_free(H0H1L0);
    gsl_matrix_complex_free(H1H3L1);
    gsl_matrix_complex_free(H0L2H3);
    gsl_matrix_complex_free(H0L0L0);
    gsl_matrix_complex_free(H0H2L0);
    gsl_matrix_complex_free(H2H2H2);
    gsl_matrix_complex_free(H3L0L2);
    gsl_matrix_complex_free(H3L3L3);
    gsl_matrix_complex_free(H3L2L2);
    gsl_matrix_complex_free(H1L2L0);
    gsl_matrix_complex_free(H2L3L1);
    gsl_matrix_complex_free(H2H3H3);
    gsl_matrix_complex_free(H1L1L1);
    gsl_matrix_complex_free(L0L3L2);
    gsl_matrix_complex_free(H1H2H2);
    gsl_matrix_complex_free(H1H3L3);
    gsl_matrix_complex_free(H1L3L3);
    gsl_matrix_complex_free(H0H0H3);
    gsl_matrix_complex_free(H3L2L0);
    gsl_matrix_complex_free(H2H3L2);
    gsl_matrix_complex_free(L0L3L1);
    gsl_matrix_complex_free(H3H3H3);
    gsl_matrix_complex_free(L1L3L2);
    gsl_matrix_complex_free(H3L1L0);
    gsl_matrix_complex_free(H1L2L3);
    gsl_matrix_complex_free(L0L1L3);
    gsl_matrix_complex_free(H2H3L3);
    gsl_matrix_complex_free(H3L1L1);
    gsl_matrix_complex_free(H0H2H2);
    gsl_matrix_complex_free(H1L3L2);
    gsl_matrix_complex_free(H0L0L3);
    gsl_matrix_complex_free(H2L2H3);
    gsl_matrix_complex_free(H1L3H2);
    gsl_matrix_complex_free(H0H0H2);
    gsl_matrix_complex_free(H0H3L2);
    gsl_matrix_complex_free(H0L1L3);
    gsl_matrix_complex_free(L0L1L2);
    gsl_matrix_complex_free(H0H0H0);
    gsl_matrix_complex_free(H1L2L1);
    gsl_matrix_complex_free(L0L2L1);
    gsl_matrix_complex_free(H2L2L2);
    gsl_matrix_complex_free(H2L1L1);
    gsl_matrix_complex_free(H1L0L0);
    gsl_matrix_complex_free(H1L1L2);
    gsl_matrix_complex_free(H0L3L1);
    gsl_matrix_complex_free(H0H3H3);
    gsl_matrix_complex_free(H0L3L2);
    gsl_matrix_complex_free(H1L2L2);
    gsl_matrix_complex_free(H3L0L0);
    gsl_matrix_complex_free(H2L1L3);
    gsl_matrix_complex_free(H0L1L1);
    gsl_matrix_complex_free(H0L3L0);
    gsl_matrix_complex_free(H2L1L0);
    gsl_matrix_complex_free(L1L2L3);
    gsl_matrix_complex_free(H0H1H1);
    gsl_matrix_complex_free(H0L2H2);
    gsl_matrix_complex_free(L0L2L3);
    gsl_matrix_complex_free(H0L0H1);
    gsl_matrix_complex_free(H0H1L1);
    gsl_matrix_complex_free(H0L0H2);
    gsl_matrix_complex_free(H0H2L2);
    gsl_matrix_complex_free(H1L3H3);
    gsl_matrix_complex_free(H3L3L0);
    gsl_matrix_complex_free(H0H0H1H1);
    gsl_matrix_complex_free(H1H3L2L0);
    gsl_matrix_complex_free(L0L1L0L1);
    gsl_matrix_complex_free(H3H3L0L0);
    gsl_matrix_complex_free(H1H3H2L3);
    gsl_matrix_complex_free(H0L1H3H1);
    gsl_matrix_complex_free(H0H3L0L3);
    gsl_matrix_complex_free(H1L3H3H2);
    gsl_matrix_complex_free(H0H2L0H1);
    gsl_matrix_complex_free(H1H2H3L3);
    gsl_matrix_complex_free(H2L3H2L3);
    gsl_matrix_complex_free(H0H1H3L1);
    gsl_matrix_complex_free(L2L3L2L3);
    gsl_matrix_complex_free(H0L1L3H2);
    gsl_matrix_complex_free(H1L1H1L1);
    gsl_matrix_complex_free(H0L2L1L0);
    gsl_matrix_complex_free(H0L2H2H3);
    gsl_matrix_complex_free(H2H2L1L1);
    gsl_matrix_complex_free(H3L3H3L3);
    gsl_matrix_complex_free(H3L3L2L1);
    gsl_matrix_complex_free(H1L0L2H3);
    gsl_matrix_complex_free(H1L1L2H2);
    gsl_matrix_complex_free(H1L0L3L1);
    gsl_matrix_complex_free(H1H3L3H2);
    gsl_matrix_complex_free(H0H3L1H1);
    gsl_matrix_complex_free(H0H1H2L0);
    gsl_matrix_complex_free(L0L0L1L1);
    gsl_matrix_complex_free(H0L0L1L2);
    gsl_matrix_complex_free(H0L3H1L2);
    gsl_matrix_complex_free(H3L1L2L3);
    gsl_matrix_complex_free(H0L1H1H3);
    gsl_matrix_complex_free(H0H0H0H0);
    gsl_matrix_complex_free(H0H2L1L3);
    gsl_matrix_complex_free(H1L0H1L0);
    gsl_matrix_complex_free(L0L3L0L3);
    gsl_matrix_complex_free(H2L1L0H3);
    gsl_matrix_complex_free(H0L0L2L1);
    gsl_matrix_complex_free(H0H3L3L0);
    gsl_matrix_complex_free(H1L3L1L0);
    gsl_matrix_complex_free(H1H1L1L1);
    gsl_matrix_complex_free(H0L0H2H1);
    gsl_matrix_complex_free(H0L1L0L2);
    gsl_matrix_complex_free(H1H2L2L1);
    gsl_matrix_complex_free(H2L0H3L1);
    gsl_matrix_complex_free(H0H0L1L1);
    gsl_matrix_complex_free(H2L0L3L2);
    gsl_matrix_complex_free(H1L2H1L2);
    gsl_matrix_complex_free(H0L1H0L1);
    gsl_matrix_complex_free(H2L0H2L0);
    gsl_matrix_complex_free(H0H0L3L3);
    gsl_matrix_complex_free(H2L2H2L2);
    gsl_matrix_complex_free(H0L1L2L0);
    gsl_matrix_complex_free(H1L1L0L3);
    gsl_matrix_complex_free(L0L0L3L3);
    gsl_matrix_complex_free(H1H1H3H3);
    gsl_matrix_complex_free(H2H2L3L3);
    gsl_matrix_complex_free(H3H3L1L1);
    gsl_matrix_complex_free(L1L1L2L2);
    gsl_matrix_complex_free(L1L1L3L3);
    gsl_matrix_complex_free(H3L2H3L2);
    gsl_matrix_complex_free(H0H1L0H2);
    gsl_matrix_complex_free(H0L0H1H2);
    gsl_matrix_complex_free(H3L2L1L3);
    gsl_matrix_complex_free(H2H3H2H3);
    gsl_matrix_complex_free(H2H3L1L0);
    gsl_matrix_complex_free(H1H2L1L2);
    gsl_matrix_complex_free(L1L2L1L2);
    gsl_matrix_complex_free(H2L0L1H3);
    gsl_matrix_complex_free(H0H1L2L3);
    gsl_matrix_complex_free(H0L2H1L3);
    gsl_matrix_complex_free(H0H2H3L2);
    gsl_matrix_complex_free(H0H2L3L1);
    gsl_matrix_complex_free(H1L2L0H3);
    gsl_matrix_complex_free(H0H3H1L1);
    gsl_matrix_complex_free(H2L3L0L2);
    gsl_matrix_complex_free(H3L1H3L1);
    gsl_matrix_complex_free(H1L3L0L1);
    gsl_matrix_complex_free(H1L0L1L3);
    gsl_matrix_complex_free(H0L3H2L1);
    gsl_matrix_complex_free(H1L2L1H2);
    gsl_matrix_complex_free(H1H3H1H3);
    gsl_matrix_complex_free(H3L3L1L2);
    gsl_matrix_complex_free(H0H0L0L0);
    gsl_matrix_complex_free(H0L2H3H2);
    gsl_matrix_complex_free(H0H1H0H1);
    gsl_matrix_complex_free(L0L2L0L2);
    gsl_matrix_complex_free(H2L1H2L1);
    gsl_matrix_complex_free(H2L2L3L0);
    gsl_matrix_complex_free(H0H2L2H3);
    gsl_matrix_complex_free(H1H1H2H2);
    gsl_matrix_complex_free(L1L3L1L3);
    gsl_matrix_complex_free(H0L0H0L0);
    gsl_matrix_complex_free(H3L2L3L1);
    gsl_matrix_complex_free(H0L0H3L3);
    gsl_matrix_complex_free(H1L2H2L1);
    gsl_matrix_complex_free(H0L1H2L3);
    gsl_matrix_complex_free(H1H1H1H1);
    gsl_matrix_complex_free(L2L2L3L3);
    gsl_matrix_complex_free(H1L3H1L3);
    gsl_matrix_complex_free(H1H3L0L2);
    gsl_matrix_complex_free(H1L0H3L2);
    gsl_matrix_complex_free(H3H3L3L3);
    gsl_matrix_complex_free(H1L3H2H3);
    gsl_matrix_complex_free(H1H2L3H3);
    gsl_matrix_complex_free(L0L0L2L2);
    gsl_matrix_complex_free(H0H3H0H3);
    gsl_matrix_complex_free(H0L3L2H1);
    gsl_matrix_complex_free(H1L2H3L0);
    gsl_matrix_complex_free(H0L2L3H1);
    gsl_matrix_complex_free(L0L0L0L0);
    gsl_matrix_complex_free(H0H1L1H3);
    gsl_matrix_complex_free(H0H0H3H3);
    gsl_matrix_complex_free(H1L1L3L0);
    gsl_matrix_complex_free(H1H1L3L3);
    gsl_matrix_complex_free(L2L2L2L2);
    gsl_matrix_complex_free(H2H3L0L1);
    gsl_matrix_complex_free(H1L1H2L2);
    gsl_matrix_complex_free(H2H2L2L2);
    gsl_matrix_complex_free(H2L2L0L3);
    gsl_matrix_complex_free(H3H3H3H3);
    gsl_matrix_complex_free(H0L3H0L3);
    gsl_matrix_complex_free(H2H2L0L0);
    gsl_matrix_complex_free(H0H2H0H2);
    gsl_matrix_complex_free(H2H2H3H3);
    gsl_matrix_complex_free(H0L3H3L0);
    gsl_matrix_complex_free(H0L2H0L2);
    gsl_matrix_complex_free(H0L3L1H2);
    gsl_matrix_complex_free(H0H0H2H2);
    gsl_matrix_complex_free(H0H3L2H2);
    gsl_matrix_complex_free(H0L3L0H3);
    gsl_matrix_complex_free(H2L0L2L3);
    gsl_matrix_complex_free(H3L1L3L2);
    gsl_matrix_complex_free(H1H1L2L2);
    gsl_matrix_complex_free(H2L3L2L0);
    gsl_matrix_complex_free(H0H3H2L2);
    gsl_matrix_complex_free(H0L2L0L1);
    gsl_matrix_complex_free(H0H1L3L2);
    gsl_matrix_complex_free(H1H2H1H2);
    gsl_matrix_complex_free(H2L1H3L0);
    gsl_matrix_complex_free(H0H2H1L0);
    gsl_matrix_complex_free(H0L0L3H3);
    gsl_matrix_complex_free(L1L1L1L1);
    gsl_matrix_complex_free(H3L0H3L0);
    gsl_matrix_complex_free(L3L3L3L3);
    gsl_matrix_complex_free(H3H3L2L2);
    gsl_matrix_complex_free(H2H2H2H2);
    gsl_matrix_complex_free(H0H0L2L2);
    gsl_matrix_complex_free(H1H1L0L0);
    if(control[0])
    vecS[0] = G*(+8*GSL_REAL(gsl_complex_mul(trH1,trH1))+8*dim*GSL_REAL(trH3H3)+8*dim*GSL_REAL(trH0H0)+8*dim*GSL_REAL(trH1H1)+8*GSL_REAL(gsl_complex_mul(trH2,trH2))+8*dim*GSL_REAL(trH2H2)+8*GSL_REAL(gsl_complex_mul(trH3,trH3))+8*dim*GSL_REAL(trL3L3)+8*dim*GSL_REAL(trL0L0)+8*dim*GSL_REAL(trL1L1)+8*dim*GSL_REAL(trL2L2)+8*GSL_REAL(gsl_complex_mul(trH0,trH0))) +16*dim*GSL_REAL(trH0H2H0H2)-96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trH2L3H3)))+32*GSL_REAL(gsl_complex_mul(trH2,trH3L0L1))-16*dim*GSL_REAL(trH3L2H3L2)+32*dim*GSL_REAL(trH1H1H3H3)-32*GSL_REAL(gsl_complex_mul(trH1L2L1,trH2))-16*dim*GSL_REAL(trH3L0H3L0)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H2L3H3))-32*GSL_REAL(gsl_complex_mul(trH0L0L3,trH3))+96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH2H3L2)))+16*dim*GSL_REAL(trL0L2L0L2)+32*dim*GSL_REAL(trH0L2H1L3)+32*GSL_REAL(gsl_complex_mul(trH1L0L2,trH3))-32*GSL_REAL(gsl_complex_mul(trH0L1,trH0L1))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L2H3,trH2)))+16*dim*GSL_REAL(trH0H3H0H3)-16*dim*GSL_REAL(trH2L2H2L2)+32*GSL_REAL(gsl_complex_mul(trH3,trH3H3H3))+32*GSL_REAL(gsl_complex_mul(trH0H1,trH0H1))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L3L2L1))-64*GSL_REAL(gsl_complex_mul(trH1H2,trL1L2))-32*dim*GSL_REAL(trH1H2L2L1)+32*GSL_REAL(gsl_complex_mul(trH2L1L0,trH3))+32*dim*GSL_REAL(trL0L0L1L1)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2L1L0))-32*dim*GSL_REAL(trH0H1L2L3)-96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L1H1,trH3)))-32*GSL_REAL(gsl_complex_mul(trH2L2,trH2L2))-32*dim*GSL_REAL(trH2H3L0L1)+32*dim*GSL_REAL(trH2H2L3L3)-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH3,trL1L3L2)))+16*dim*GSL_REAL(trH1L3H1L3)-16*dim*GSL_REAL(trH0H1H0H1)-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L1H3,trH1)))+96*GSL_REAL(gsl_complex_mul(trH1H3,trH1H3))+8*dim*GSL_REAL(trH0H0H0H0)+32*GSL_REAL(gsl_complex_mul(trH1L2L0,trH3))-96*GSL_REAL(gsl_complex_mul(trH0L2,trH0L2))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L0L3L2))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2L0L1))+32*dim*GSL_REAL(trH3H3L3L3)+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H2L0,trH1)))+48*GSL_REAL(gsl_complex_mul(trH0H0,trH2H2))+96*GSL_REAL(gsl_complex_mul(trH0,trH0H2H2))+24*GSL_REAL(gsl_complex_mul(trH0H0,trH0H0))-32*dim*GSL_REAL(trH0L3H2L1)+16*dim*GSL_REAL(trL1L3L1L3)+32*GSL_REAL(gsl_complex_mul(trH0,trH2L3L1))+32*dim*GSL_REAL(trH1H1L1L1)+32*GSL_REAL(gsl_complex_mul(trH1,trH3L2L0))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trL0L1L3)))-32*GSL_REAL(gsl_complex_mul(trH0L0,trH0L0))-96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH2L2H3)))+32*GSL_REAL(gsl_complex_mul(trH0,trH1L3L2))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2L2H3))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1L2L0))+32*dim*GSL_REAL(trH0H0H1H1)+8*dim*GSL_REAL(trL2L2L2L2)+32*dim*GSL_REAL(trH0L3H1L2)-32*GSL_REAL(gsl_complex_mul(trH1L1,trH1L1))+48*GSL_REAL(gsl_complex_mul(trH3H3,trL1L1))+32*GSL_REAL(gsl_complex_mul(trH0L2L3,trH1))+32*GSL_REAL(gsl_complex_mul(trH3,trH3L0L0))+32*dim*GSL_REAL(trH0H2L1L3)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3H2L2))+32*dim*GSL_REAL(trH0L1L3H2)+32*dim*GSL_REAL(trH0H0L3L3)+32*dim*GSL_REAL(trH1L0L2H3)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L1L0L3))-16*dim*GSL_REAL(trH1L0H1L0)+32*GSL_REAL(gsl_complex_mul(trH0L3L2,trH1))-32*dim*GSL_REAL(trH0L3L2H1)+32*dim*GSL_REAL(trH0L2L3H1)-64*GSL_REAL(gsl_complex_mul(trH0L3,trH1L2))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0H2H1))+32*GSL_REAL(gsl_complex_mul(trH0,trH2L1L3))-64*GSL_REAL(gsl_complex_mul(trH1L0,trH3L2))+32*dim*GSL_REAL(trH0H0L1L1)+32*dim*GSL_REAL(trH0H0L2L2)+16*GSL_REAL(gsl_complex_mul(trL0L0,trL1L1))+32*dim*GSL_REAL(trH1H1L0L0)+96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trH2H3L3)))+32*GSL_REAL(gsl_complex_mul(trL0L1,trL0L1))+64*GSL_REAL(gsl_complex_mul(trH2H3,trL0L1))+32*dim*GSL_REAL(trH3H3L1L1)+32*GSL_REAL(gsl_complex_mul(trH2,trH2H3H3))-32*GSL_REAL(gsl_complex_mul(trH3L0,trH3L0))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1H2L0)))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0L1L2))+96*GSL_REAL(gsl_complex_mul(trH1H1H3,trH3))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L2H2,trH3)))-32*GSL_REAL(gsl_complex_mul(trH1,trH2L2L1))+32*dim*GSL_REAL(trH2H2L1L1)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2L0H1))+32*dim*GSL_REAL(trL0L0L2L2)+32*dim*GSL_REAL(trH2H2L0L0)+32*GSL_REAL(gsl_complex_mul(trH3,trH3L2L2))+8*dim*GSL_REAL(trL1L1L1L1)-32*GSL_REAL(gsl_complex_mul(trH0L3L0,trH3))+96*GSL_REAL(gsl_complex_mul(trH0H2,trH0H2))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0L2L1))+32*dim*GSL_REAL(trH2H2L2L2)-32*GSL_REAL(gsl_complex_mul(trH2L3,trH2L3))+96*GSL_REAL(gsl_complex_mul(trL1L3,trL1L3))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3L1H1))-96*GSL_REAL(gsl_complex_mul(trH2L0,trH2L0))-64*GSL_REAL(gsl_complex_mul(trH0L2,trH1L3))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1H3L3,trH2)))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L1L3L2))+48*GSL_REAL(gsl_complex_mul(trH1H1,trH3H3))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L2L1L3))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1H3L1)))+96*GSL_REAL(gsl_complex_mul(trH0H0H3,trH3))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1L3H3,trH2)))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L0L2L3))+32*GSL_REAL(gsl_complex_mul(trH0H0H1,trH1))+32*dim*GSL_REAL(trH3H3L2L2)-16*dim*GSL_REAL(trH3L3H3L3)+24*GSL_REAL(gsl_complex_mul(trL2L2,trL2L2))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L1L3L0))+32*dim*GSL_REAL(trH1H1L3L3)-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L0H2,trH1)))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trL0L2L1)))+32*GSL_REAL(gsl_complex_mul(trH0,trH0L1L1))+32*dim*GSL_REAL(trH0H1L3L2)+32*GSL_REAL(gsl_complex_mul(trH1,trH1H1H1))+32*dim*GSL_REAL(trH2H2H3H3)-64*GSL_REAL(gsl_complex_mul(trH2L1,trH3L0))+32*dim*GSL_REAL(trH0H0L0L0)+64*GSL_REAL(gsl_complex_mul(trH0H1,trL2L3))-32*GSL_REAL(gsl_complex_mul(trH1,trH2L1L2))+8*dim*GSL_REAL(trL3L3L3L3)-16*dim*GSL_REAL(trL0L1L0L1)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L1L2L3))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L2L3L0))+32*dim*GSL_REAL(trH3H3L0L0)+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H3L1,trH1)))+16*dim*GSL_REAL(trH1H2H1H2)+24*GSL_REAL(gsl_complex_mul(trH1H1,trH1H1))+8*dim*GSL_REAL(trH1H1H1H1)-32*dim*GSL_REAL(trH0L1H2L3)+16*GSL_REAL(gsl_complex_mul(trH0H0,trH1H1))+32*dim*GSL_REAL(trH2L0H3L1)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H3L3H2))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H2H3L3))-32*GSL_REAL(gsl_complex_mul(trH0L3,trH0L3))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1L1H3)))+16*dim*GSL_REAL(trH3L1H3L1)+16*GSL_REAL(gsl_complex_mul(trH1H1,trL0L0))+32*GSL_REAL(gsl_complex_mul(trH2,trH2H2H2))+16*GSL_REAL(gsl_complex_mul(trH3H3,trL3L3))-32*GSL_REAL(gsl_complex_mul(trH0,trH3L3L0))+32*GSL_REAL(gsl_complex_mul(trH1,trH3L0L2))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1L1H3))-32*GSL_REAL(gsl_complex_mul(trH3L2,trH3L2))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L2L0L3))+32*GSL_REAL(gsl_complex_mul(trH0,trH0H1H1))+32*dim*GSL_REAL(trH1H1L2L2)+48*GSL_REAL(gsl_complex_mul(trL0L0,trL3L3))+32*dim*GSL_REAL(trH0H0H2H2)+64*GSL_REAL(gsl_complex_mul(trH1L2,trH2L1))+96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H1L0,trH2)))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2H3H2))-32*GSL_REAL(gsl_complex_mul(trH1L1L2,trH2))-32*dim*GSL_REAL(trH1L1L2H2)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L3L2L0))+96*GSL_REAL(gsl_complex_mul(trH1,trH1H3H3))+32*dim*GSL_REAL(trL1L1L3L3)-16*dim*GSL_REAL(trL2L3L2L3)-64*GSL_REAL(gsl_complex_mul(trH0L1,trH2L3))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3H3H2))+96*GSL_REAL(gsl_complex_mul(trL0L2,trL0L2))+16*GSL_REAL(gsl_complex_mul(trL2L2,trL3L3))-16*dim*GSL_REAL(trH0L0H0L0)+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH2,trL0L2L3)))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H3L2,trH2)))+48*GSL_REAL(gsl_complex_mul(trH1H1,trL3L3))+32*GSL_REAL(gsl_complex_mul(trH0,trH0H0H0))+32*GSL_REAL(gsl_complex_mul(trH0,trH1L2L3))-32*dim*GSL_REAL(trH1H2L1L2)+32*GSL_REAL(gsl_complex_mul(trH1,trH1L1L1))+64*GSL_REAL(gsl_complex_mul(trH1L1,trH2L2))+32*GSL_REAL(gsl_complex_mul(trH3,trH3L3L3))+48*GSL_REAL(gsl_complex_mul(trL1L1,trL2L2))-64*GSL_REAL(gsl_complex_mul(trH1L2,trH3L0))+96*GSL_REAL(gsl_complex_mul(trH1H1H2,trH2))+32*dim*GSL_REAL(trH1L2L0H3)+16*dim*GSL_REAL(trH1H3H1H3)+32*GSL_REAL(gsl_complex_mul(trH0L3L1,trH2))-32*dim*GSL_REAL(trH0H3L3L0)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3H1L1))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L0L3L1))+96*GSL_REAL(gsl_complex_mul(trH1,trH1H2H2))+8*dim*GSL_REAL(trH2H2H2H2)+32*GSL_REAL(gsl_complex_mul(trH0,trH0L0L0))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3L1L0))-16*dim*GSL_REAL(trH2L3H2L3)+16*GSL_REAL(gsl_complex_mul(trH3H3,trL0L0))+32*GSL_REAL(gsl_complex_mul(trH2H3,trH2H3))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trL0L1L2)))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0H1H2))+48*GSL_REAL(gsl_complex_mul(trH1H1,trH2H2))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1L0L2))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H2L2,trH3)))+32*GSL_REAL(gsl_complex_mul(trH1,trH1L2L2))+64*GSL_REAL(gsl_complex_mul(trH1H3,trL0L2))+96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H1L1,trH3)))+32*GSL_REAL(gsl_complex_mul(trH2,trH2L3L3))-32*GSL_REAL(gsl_complex_mul(trH0,trH3L0L3))-16*dim*GSL_REAL(trH0L3H0L3)+96*GSL_REAL(gsl_complex_mul(trL0L3,trL0L3))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L3L0L2))+32*dim*GSL_REAL(trH1L1H2L2)+32*GSL_REAL(gsl_complex_mul(trH2,trH2L1L1))+96*GSL_REAL(gsl_complex_mul(trH0,trH0H3H3))-32*dim*GSL_REAL(trH1L2L1H2)+32*GSL_REAL(gsl_complex_mul(trH1,trH1L0L0))-16*dim*GSL_REAL(trH1L2H1L2)-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1H1H3))+16*dim*GSL_REAL(trH0L2H0L2)-32*dim*GSL_REAL(trH0L0L3H3)+96*GSL_REAL(gsl_complex_mul(trH0H0H2,trH2))-64*GSL_REAL(gsl_complex_mul(trH2L0,trH3L1))+8*dim*GSL_REAL(trL0L0L0L0)+8*dim*GSL_REAL(trH3H3H3H3)+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1L3H2,trH3)))+64*GSL_REAL(gsl_complex_mul(trH0L0,trH3L3))+48*GSL_REAL(gsl_complex_mul(trL0L0,trL2L2))+24*GSL_REAL(gsl_complex_mul(trH2H2,trH2H2))+16*GSL_REAL(gsl_complex_mul(trH3H3,trL2L2))-32*GSL_REAL(gsl_complex_mul(trH1L0,trH1L0))+32*dim*GSL_REAL(trH0L0H3L3)-32*dim*GSL_REAL(trH1L0H3L2)-32*GSL_REAL(gsl_complex_mul(trH2L1,trH2L1))+32*GSL_REAL(gsl_complex_mul(trL2L3,trL2L3))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3L2H2))+32*GSL_REAL(gsl_complex_mul(trH2,trH3L1L0))+32*dim*GSL_REAL(trH1L2H2L1)-64*GSL_REAL(gsl_complex_mul(trH0L3,trH2L1))+32*dim*GSL_REAL(trH2L1H3L0)+32*dim*GSL_REAL(trH0L3H3L0)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3H2H3))+48*GSL_REAL(gsl_complex_mul(trH2H2,trL0L0))-64*GSL_REAL(gsl_complex_mul(trH0H3,trL0L3))+16*GSL_REAL(gsl_complex_mul(trH1H1,trL2L2))-16*dim*GSL_REAL(trH2H3H2H3)+24*GSL_REAL(gsl_complex_mul(trL3L3,trL3L3))+32*dim*GSL_REAL(trH1H1H2H2)+48*GSL_REAL(gsl_complex_mul(trH0H0,trH3H3))-32*GSL_REAL(gsl_complex_mul(trH3L3,trH3L3))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L0L1L3))+32*GSL_REAL(gsl_complex_mul(trH0L1L3,trH2))-16*dim*GSL_REAL(trH2L1H2L1)+32*dim*GSL_REAL(trH1H3L0L2)+16*dim*GSL_REAL(trL1L2L1L2)+96*GSL_REAL(gsl_complex_mul(trH0H3,trH0H3))+16*GSL_REAL(gsl_complex_mul(trH0H0,trL0L0))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trL0L3L1)))+16*dim*GSL_REAL(trL0L3L0L3)+48*GSL_REAL(gsl_complex_mul(trL1L1,trL3L3))-96*GSL_REAL(gsl_complex_mul(trH1L3,trH1L3))+16*dim*GSL_REAL(trH2L0H2L0)+32*dim*GSL_REAL(trL2L2L3L3)+24*GSL_REAL(gsl_complex_mul(trL1L1,trL1L1))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1L0H2)))+32*GSL_REAL(gsl_complex_mul(trH2L0L1,trH3))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2H3L2))-32*dim*GSL_REAL(trH0L3L0H3)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2H1L0))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1H3L1))+16*GSL_REAL(gsl_complex_mul(trH2H2,trL3L3))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L3L1L2))+24*GSL_REAL(gsl_complex_mul(trL0L0,trL0L0))+32*GSL_REAL(gsl_complex_mul(trH0,trH0L3L3))+48*GSL_REAL(gsl_complex_mul(trH0H0,trL2L2))+16*GSL_REAL(gsl_complex_mul(trH0H0,trL1L1))+32*GSL_REAL(gsl_complex_mul(trH2H2H3,trH3))+16*GSL_REAL(gsl_complex_mul(trH2H2,trL2L2))+96*GSL_REAL(gsl_complex_mul(trH3,trH3L1L1))+32*dim*GSL_REAL(trH1H3L2L0)+64*GSL_REAL(gsl_complex_mul(trH0L3,trH3L0))+96*GSL_REAL(gsl_complex_mul(trH1,trH1L3L3))+32*dim*GSL_REAL(trH0H2L3L1)+32*dim*GSL_REAL(trH2L0L1H3)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1H2L0))+64*GSL_REAL(gsl_complex_mul(trH0H2,trL1L3))+32*dim*GSL_REAL(trL0L0L3L3)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L2L3L1))+96*GSL_REAL(gsl_complex_mul(trH1H2,trH1H2))+16*GSL_REAL(gsl_complex_mul(trH0H0,trL3L3))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H3H2L3))-16*dim*GSL_REAL(trH0L1H0L1)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2H2H3))+32*dim*GSL_REAL(trH0L3L1H2)+16*GSL_REAL(gsl_complex_mul(trH2H2,trH3H3))-32*dim*GSL_REAL(trH1L2H3L0)+32*GSL_REAL(gsl_complex_mul(trH2,trH2L2L2))+32*dim*GSL_REAL(trH0H0H3H3)+96*GSL_REAL(gsl_complex_mul(trH2,trH2L0L0))+32*dim*GSL_REAL(trH2H3L1L0)+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3L0L1))-96*GSL_REAL(gsl_complex_mul(trH3L1,trH3L1))-16*dim*GSL_REAL(trH1L1H1L1)-32*dim*GSL_REAL(trH0H3L0L3)-32*dim*GSL_REAL(trH2L1L0H3)-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1H2L3,trH3)))+96*GSL_REAL(gsl_complex_mul(trH0,trH0L2L2))-96*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L0H1,trH2)))-32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1H3H1))+16*GSL_REAL(gsl_complex_mul(trH2H2,trL1L1))+24*GSL_REAL(gsl_complex_mul(trH3H3,trH3H3))+32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH3,trL1L2L3)))+32*dim*GSL_REAL(trL1L1L2L2)+96*GSL_REAL(gsl_complex_mul(trL1L2,trL1L2))+32*dim*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1L0H2))-32*GSL_REAL(gsl_complex_mul(trH1L2,trH1L2))-32*GSL_REAL(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH2,trL0L3L2)))+16*GSL_REAL(gsl_complex_mul(trH1H1,trL1L1));
    if(control[1])
    vecS[1] = G*(+8*GSL_IMAG(gsl_complex_mul(trH1,trH1))+8*dim*GSL_IMAG(trH3H3)+8*dim*GSL_IMAG(trH0H0)+8*dim*GSL_IMAG(trH1H1)+8*GSL_IMAG(gsl_complex_mul(trH2,trH2))+8*dim*GSL_IMAG(trH2H2)+8*GSL_IMAG(gsl_complex_mul(trH3,trH3))+8*dim*GSL_IMAG(trL3L3)+8*dim*GSL_IMAG(trL0L0)+8*dim*GSL_IMAG(trL1L1)+8*dim*GSL_IMAG(trL2L2)+8*GSL_IMAG(gsl_complex_mul(trH0,trH0))) +16*dim*GSL_IMAG(trH0H2H0H2)-96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trH2L3H3)))+32*GSL_IMAG(gsl_complex_mul(trH2,trH3L0L1))-16*dim*GSL_IMAG(trH3L2H3L2)+32*dim*GSL_IMAG(trH1H1H3H3)-32*GSL_IMAG(gsl_complex_mul(trH1L2L1,trH2))-16*dim*GSL_IMAG(trH3L0H3L0)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H2L3H3))-32*GSL_IMAG(gsl_complex_mul(trH0L0L3,trH3))+96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH2H3L2)))+16*dim*GSL_IMAG(trL0L2L0L2)+32*dim*GSL_IMAG(trH0L2H1L3)+32*GSL_IMAG(gsl_complex_mul(trH1L0L2,trH3))-32*GSL_IMAG(gsl_complex_mul(trH0L1,trH0L1))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L2H3,trH2)))+16*dim*GSL_IMAG(trH0H3H0H3)-16*dim*GSL_IMAG(trH2L2H2L2)+32*GSL_IMAG(gsl_complex_mul(trH3,trH3H3H3))+32*GSL_IMAG(gsl_complex_mul(trH0H1,trH0H1))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L3L2L1))-64*GSL_IMAG(gsl_complex_mul(trH1H2,trL1L2))-32*dim*GSL_IMAG(trH1H2L2L1)+32*GSL_IMAG(gsl_complex_mul(trH2L1L0,trH3))+32*dim*GSL_IMAG(trL0L0L1L1)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2L1L0))-32*dim*GSL_IMAG(trH0H1L2L3)-96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L1H1,trH3)))-32*GSL_IMAG(gsl_complex_mul(trH2L2,trH2L2))-32*dim*GSL_IMAG(trH2H3L0L1)+32*dim*GSL_IMAG(trH2H2L3L3)-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH3,trL1L3L2)))+16*dim*GSL_IMAG(trH1L3H1L3)-16*dim*GSL_IMAG(trH0H1H0H1)-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L1H3,trH1)))+96*GSL_IMAG(gsl_complex_mul(trH1H3,trH1H3))+8*dim*GSL_IMAG(trH0H0H0H0)+32*GSL_IMAG(gsl_complex_mul(trH1L2L0,trH3))-96*GSL_IMAG(gsl_complex_mul(trH0L2,trH0L2))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L0L3L2))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2L0L1))+32*dim*GSL_IMAG(trH3H3L3L3)+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H2L0,trH1)))+48*GSL_IMAG(gsl_complex_mul(trH0H0,trH2H2))+96*GSL_IMAG(gsl_complex_mul(trH0,trH0H2H2))+24*GSL_IMAG(gsl_complex_mul(trH0H0,trH0H0))-32*dim*GSL_IMAG(trH0L3H2L1)+16*dim*GSL_IMAG(trL1L3L1L3)+32*GSL_IMAG(gsl_complex_mul(trH0,trH2L3L1))+32*dim*GSL_IMAG(trH1H1L1L1)+32*GSL_IMAG(gsl_complex_mul(trH1,trH3L2L0))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trL0L1L3)))-32*GSL_IMAG(gsl_complex_mul(trH0L0,trH0L0))-96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH2L2H3)))+32*GSL_IMAG(gsl_complex_mul(trH0,trH1L3L2))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2L2H3))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1L2L0))+32*dim*GSL_IMAG(trH0H0H1H1)+8*dim*GSL_IMAG(trL2L2L2L2)+32*dim*GSL_IMAG(trH0L3H1L2)-32*GSL_IMAG(gsl_complex_mul(trH1L1,trH1L1))+48*GSL_IMAG(gsl_complex_mul(trH3H3,trL1L1))+32*GSL_IMAG(gsl_complex_mul(trH0L2L3,trH1))+32*GSL_IMAG(gsl_complex_mul(trH3,trH3L0L0))+32*dim*GSL_IMAG(trH0H2L1L3)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3H2L2))+32*dim*GSL_IMAG(trH0L1L3H2)+32*dim*GSL_IMAG(trH0H0L3L3)+32*dim*GSL_IMAG(trH1L0L2H3)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L1L0L3))-16*dim*GSL_IMAG(trH1L0H1L0)+32*GSL_IMAG(gsl_complex_mul(trH0L3L2,trH1))-32*dim*GSL_IMAG(trH0L3L2H1)+32*dim*GSL_IMAG(trH0L2L3H1)-64*GSL_IMAG(gsl_complex_mul(trH0L3,trH1L2))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0H2H1))+32*GSL_IMAG(gsl_complex_mul(trH0,trH2L1L3))-64*GSL_IMAG(gsl_complex_mul(trH1L0,trH3L2))+32*dim*GSL_IMAG(trH0H0L1L1)+32*dim*GSL_IMAG(trH0H0L2L2)+16*GSL_IMAG(gsl_complex_mul(trL0L0,trL1L1))+32*dim*GSL_IMAG(trH1H1L0L0)+96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trH2H3L3)))+32*GSL_IMAG(gsl_complex_mul(trL0L1,trL0L1))+64*GSL_IMAG(gsl_complex_mul(trH2H3,trL0L1))+32*dim*GSL_IMAG(trH3H3L1L1)+32*GSL_IMAG(gsl_complex_mul(trH2,trH2H3H3))-32*GSL_IMAG(gsl_complex_mul(trH3L0,trH3L0))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1H2L0)))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0L1L2))+96*GSL_IMAG(gsl_complex_mul(trH1H1H3,trH3))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L2H2,trH3)))-32*GSL_IMAG(gsl_complex_mul(trH1,trH2L2L1))+32*dim*GSL_IMAG(trH2H2L1L1)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2L0H1))+32*dim*GSL_IMAG(trL0L0L2L2)+32*dim*GSL_IMAG(trH2H2L0L0)+32*GSL_IMAG(gsl_complex_mul(trH3,trH3L2L2))+8*dim*GSL_IMAG(trL1L1L1L1)-32*GSL_IMAG(gsl_complex_mul(trH0L3L0,trH3))+96*GSL_IMAG(gsl_complex_mul(trH0H2,trH0H2))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0L2L1))+32*dim*GSL_IMAG(trH2H2L2L2)-32*GSL_IMAG(gsl_complex_mul(trH2L3,trH2L3))+96*GSL_IMAG(gsl_complex_mul(trL1L3,trL1L3))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3L1H1))-96*GSL_IMAG(gsl_complex_mul(trH2L0,trH2L0))-64*GSL_IMAG(gsl_complex_mul(trH0L2,trH1L3))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1H3L3,trH2)))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L1L3L2))+48*GSL_IMAG(gsl_complex_mul(trH1H1,trH3H3))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L2L1L3))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1H3L1)))+96*GSL_IMAG(gsl_complex_mul(trH0H0H3,trH3))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1L3H3,trH2)))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L0L2L3))+32*GSL_IMAG(gsl_complex_mul(trH0H0H1,trH1))+32*dim*GSL_IMAG(trH3H3L2L2)-16*dim*GSL_IMAG(trH3L3H3L3)+24*GSL_IMAG(gsl_complex_mul(trL2L2,trL2L2))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L1L3L0))+32*dim*GSL_IMAG(trH1H1L3L3)-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L0H2,trH1)))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trL0L2L1)))+32*GSL_IMAG(gsl_complex_mul(trH0,trH0L1L1))+32*dim*GSL_IMAG(trH0H1L3L2)+32*GSL_IMAG(gsl_complex_mul(trH1,trH1H1H1))+32*dim*GSL_IMAG(trH2H2H3H3)-64*GSL_IMAG(gsl_complex_mul(trH2L1,trH3L0))+32*dim*GSL_IMAG(trH0H0L0L0)+64*GSL_IMAG(gsl_complex_mul(trH0H1,trL2L3))-32*GSL_IMAG(gsl_complex_mul(trH1,trH2L1L2))+8*dim*GSL_IMAG(trL3L3L3L3)-16*dim*GSL_IMAG(trL0L1L0L1)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L1L2L3))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L2L3L0))+32*dim*GSL_IMAG(trH3H3L0L0)+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H3L1,trH1)))+16*dim*GSL_IMAG(trH1H2H1H2)+24*GSL_IMAG(gsl_complex_mul(trH1H1,trH1H1))+8*dim*GSL_IMAG(trH1H1H1H1)-32*dim*GSL_IMAG(trH0L1H2L3)+16*GSL_IMAG(gsl_complex_mul(trH0H0,trH1H1))+32*dim*GSL_IMAG(trH2L0H3L1)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H3L3H2))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H2H3L3))-32*GSL_IMAG(gsl_complex_mul(trH0L3,trH0L3))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1L1H3)))+16*dim*GSL_IMAG(trH3L1H3L1)+16*GSL_IMAG(gsl_complex_mul(trH1H1,trL0L0))+32*GSL_IMAG(gsl_complex_mul(trH2,trH2H2H2))+16*GSL_IMAG(gsl_complex_mul(trH3H3,trL3L3))-32*GSL_IMAG(gsl_complex_mul(trH0,trH3L3L0))+32*GSL_IMAG(gsl_complex_mul(trH1,trH3L0L2))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1L1H3))-32*GSL_IMAG(gsl_complex_mul(trH3L2,trH3L2))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L2L0L3))+32*GSL_IMAG(gsl_complex_mul(trH0,trH0H1H1))+32*dim*GSL_IMAG(trH1H1L2L2)+48*GSL_IMAG(gsl_complex_mul(trL0L0,trL3L3))+32*dim*GSL_IMAG(trH0H0H2H2)+64*GSL_IMAG(gsl_complex_mul(trH1L2,trH2L1))+96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H1L0,trH2)))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2H3H2))-32*GSL_IMAG(gsl_complex_mul(trH1L1L2,trH2))-32*dim*GSL_IMAG(trH1L1L2H2)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L3L2L0))+96*GSL_IMAG(gsl_complex_mul(trH1,trH1H3H3))+32*dim*GSL_IMAG(trL1L1L3L3)-16*dim*GSL_IMAG(trL2L3L2L3)-64*GSL_IMAG(gsl_complex_mul(trH0L1,trH2L3))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3H3H2))+96*GSL_IMAG(gsl_complex_mul(trL0L2,trL0L2))+16*GSL_IMAG(gsl_complex_mul(trL2L2,trL3L3))-16*dim*GSL_IMAG(trH0L0H0L0)+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH2,trL0L2L3)))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H3L2,trH2)))+48*GSL_IMAG(gsl_complex_mul(trH1H1,trL3L3))+32*GSL_IMAG(gsl_complex_mul(trH0,trH0H0H0))+32*GSL_IMAG(gsl_complex_mul(trH0,trH1L2L3))-32*dim*GSL_IMAG(trH1H2L1L2)+32*GSL_IMAG(gsl_complex_mul(trH1,trH1L1L1))+64*GSL_IMAG(gsl_complex_mul(trH1L1,trH2L2))+32*GSL_IMAG(gsl_complex_mul(trH3,trH3L3L3))+48*GSL_IMAG(gsl_complex_mul(trL1L1,trL2L2))-64*GSL_IMAG(gsl_complex_mul(trH1L2,trH3L0))+96*GSL_IMAG(gsl_complex_mul(trH1H1H2,trH2))+32*dim*GSL_IMAG(trH1L2L0H3)+16*dim*GSL_IMAG(trH1H3H1H3)+32*GSL_IMAG(gsl_complex_mul(trH0L3L1,trH2))-32*dim*GSL_IMAG(trH0H3L3L0)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3H1L1))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L0L3L1))+96*GSL_IMAG(gsl_complex_mul(trH1,trH1H2H2))+8*dim*GSL_IMAG(trH2H2H2H2)+32*GSL_IMAG(gsl_complex_mul(trH0,trH0L0L0))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3L1L0))-16*dim*GSL_IMAG(trH2L3H2L3)+16*GSL_IMAG(gsl_complex_mul(trH3H3,trL0L0))+32*GSL_IMAG(gsl_complex_mul(trH2H3,trH2H3))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trL0L1L2)))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L0H1H2))+48*GSL_IMAG(gsl_complex_mul(trH1H1,trH2H2))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1L0L2))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H2L2,trH3)))+32*GSL_IMAG(gsl_complex_mul(trH1,trH1L2L2))+64*GSL_IMAG(gsl_complex_mul(trH1H3,trL0L2))+96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0H1L1,trH3)))+32*GSL_IMAG(gsl_complex_mul(trH2,trH2L3L3))-32*GSL_IMAG(gsl_complex_mul(trH0,trH3L0L3))-16*dim*GSL_IMAG(trH0L3H0L3)+96*GSL_IMAG(gsl_complex_mul(trL0L3,trL0L3))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH2L3L0L2))+32*dim*GSL_IMAG(trH1L1H2L2)+32*GSL_IMAG(gsl_complex_mul(trH2,trH2L1L1))+96*GSL_IMAG(gsl_complex_mul(trH0,trH0H3H3))-32*dim*GSL_IMAG(trH1L2L1H2)+32*GSL_IMAG(gsl_complex_mul(trH1,trH1L0L0))-16*dim*GSL_IMAG(trH1L2H1L2)-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1H1H3))+16*dim*GSL_IMAG(trH0L2H0L2)-32*dim*GSL_IMAG(trH0L0L3H3)+96*GSL_IMAG(gsl_complex_mul(trH0H0H2,trH2))-64*GSL_IMAG(gsl_complex_mul(trH2L0,trH3L1))+8*dim*GSL_IMAG(trL0L0L0L0)+8*dim*GSL_IMAG(trH3H3H3H3)+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1L3H2,trH3)))+64*GSL_IMAG(gsl_complex_mul(trH0L0,trH3L3))+48*GSL_IMAG(gsl_complex_mul(trL0L0,trL2L2))+24*GSL_IMAG(gsl_complex_mul(trH2H2,trH2H2))+16*GSL_IMAG(gsl_complex_mul(trH3H3,trL2L2))-32*GSL_IMAG(gsl_complex_mul(trH1L0,trH1L0))+32*dim*GSL_IMAG(trH0L0H3L3)-32*dim*GSL_IMAG(trH1L0H3L2)-32*GSL_IMAG(gsl_complex_mul(trH2L1,trH2L1))+32*GSL_IMAG(gsl_complex_mul(trL2L3,trL2L3))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H3L2H2))+32*GSL_IMAG(gsl_complex_mul(trH2,trH3L1L0))+32*dim*GSL_IMAG(trH1L2H2L1)-64*GSL_IMAG(gsl_complex_mul(trH0L3,trH2L1))+32*dim*GSL_IMAG(trH2L1H3L0)+32*dim*GSL_IMAG(trH0L3H3L0)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3H2H3))+48*GSL_IMAG(gsl_complex_mul(trH2H2,trL0L0))-64*GSL_IMAG(gsl_complex_mul(trH0H3,trL0L3))+16*GSL_IMAG(gsl_complex_mul(trH1H1,trL2L2))-16*dim*GSL_IMAG(trH2H3H2H3)+24*GSL_IMAG(gsl_complex_mul(trL3L3,trL3L3))+32*dim*GSL_IMAG(trH1H1H2H2)+48*GSL_IMAG(gsl_complex_mul(trH0H0,trH3H3))-32*GSL_IMAG(gsl_complex_mul(trH3L3,trH3L3))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L0L1L3))+32*GSL_IMAG(gsl_complex_mul(trH0L1L3,trH2))-16*dim*GSL_IMAG(trH2L1H2L1)+32*dim*GSL_IMAG(trH1H3L0L2)+16*dim*GSL_IMAG(trL1L2L1L2)+96*GSL_IMAG(gsl_complex_mul(trH0H3,trH0H3))+16*GSL_IMAG(gsl_complex_mul(trH0H0,trL0L0))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1,trL0L3L1)))+16*dim*GSL_IMAG(trL0L3L0L3)+48*GSL_IMAG(gsl_complex_mul(trL1L1,trL3L3))-96*GSL_IMAG(gsl_complex_mul(trH1L3,trH1L3))+16*dim*GSL_IMAG(trH2L0H2L0)+32*dim*GSL_IMAG(trL2L2L3L3)+24*GSL_IMAG(gsl_complex_mul(trL1L1,trL1L1))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0,trH1L0H2)))+32*GSL_IMAG(gsl_complex_mul(trH2L0L1,trH3))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2H3L2))-32*dim*GSL_IMAG(trH0L3L0H3)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H2H1L0))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1H3L1))+16*GSL_IMAG(gsl_complex_mul(trH2H2,trL3L3))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L3L1L2))+24*GSL_IMAG(gsl_complex_mul(trL0L0,trL0L0))+32*GSL_IMAG(gsl_complex_mul(trH0,trH0L3L3))+48*GSL_IMAG(gsl_complex_mul(trH0H0,trL2L2))+16*GSL_IMAG(gsl_complex_mul(trH0H0,trL1L1))+32*GSL_IMAG(gsl_complex_mul(trH2H2H3,trH3))+16*GSL_IMAG(gsl_complex_mul(trH2H2,trL2L2))+96*GSL_IMAG(gsl_complex_mul(trH3,trH3L1L1))+32*dim*GSL_IMAG(trH1H3L2L0)+64*GSL_IMAG(gsl_complex_mul(trH0L3,trH3L0))+96*GSL_IMAG(gsl_complex_mul(trH1,trH1L3L3))+32*dim*GSL_IMAG(trH0H2L3L1)+32*dim*GSL_IMAG(trH2L0L1H3)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1H2L0))+64*GSL_IMAG(gsl_complex_mul(trH0H2,trL1L3))+32*dim*GSL_IMAG(trL0L0L3L3)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH3L2L3L1))+96*GSL_IMAG(gsl_complex_mul(trH1H2,trH1H2))+16*GSL_IMAG(gsl_complex_mul(trH0H0,trL3L3))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1H3H2L3))-16*dim*GSL_IMAG(trH0L1H0L1)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L2H2H3))+32*dim*GSL_IMAG(trH0L3L1H2)+16*GSL_IMAG(gsl_complex_mul(trH2H2,trH3H3))-32*dim*GSL_IMAG(trH1L2H3L0)+32*GSL_IMAG(gsl_complex_mul(trH2,trH2L2L2))+32*dim*GSL_IMAG(trH0H0H3H3)+96*GSL_IMAG(gsl_complex_mul(trH2,trH2L0L0))+32*dim*GSL_IMAG(trH2H3L1L0)+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH1L3L0L1))-96*GSL_IMAG(gsl_complex_mul(trH3L1,trH3L1))-16*dim*GSL_IMAG(trH1L1H1L1)-32*dim*GSL_IMAG(trH0H3L0L3)-32*dim*GSL_IMAG(trH2L1L0H3)-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH1H2L3,trH3)))+96*GSL_IMAG(gsl_complex_mul(trH0,trH0L2L2))-96*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH0L0H1,trH2)))-32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0L1H3H1))+16*GSL_IMAG(gsl_complex_mul(trH2H2,trL1L1))+24*GSL_IMAG(gsl_complex_mul(trH3H3,trH3H3))+32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH3,trL1L2L3)))+32*dim*GSL_IMAG(trL1L1L2L2)+96*GSL_IMAG(gsl_complex_mul(trL1L2,trL1L2))+32*dim*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.), trH0H1L0H2))-32*GSL_IMAG(gsl_complex_mul(trH1L2,trH1L2))-32*GSL_IMAG(gsl_complex_mul(gsl_complex_rect(0., 1.),gsl_complex_mul(trH2,trL0L3L2)))+16*GSL_IMAG(gsl_complex_mul(trH1H1,trL1L1));
    if(control[2])
    vecS[2] = GSL_REAL(trH0);
    if(control[3])
    vecS[3] = GSL_REAL(trH0H0);
    if(control[4])
    vecS[4] = GSL_REAL(trH1);
    if(control[5])
    vecS[5] = GSL_REAL(trH1H1);
    if(control[6])
    vecS[4] = GSL_REAL(trH2);
    if(control[7])
    vecS[7] = GSL_REAL(trH2H2);
    if(control[8])
    vecS[8] = GSL_REAL(trH3);
    if(control[9])
    vecS[9] = GSL_REAL(trH3H3);
}

